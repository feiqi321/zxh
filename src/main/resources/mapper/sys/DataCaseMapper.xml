<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xyz.zaijushou.zhx.sys.dao.DataCaseMapper">

    <sql id="detailColSql">
        DISTINCT da.id as id,
        dbo.fnFormatDate(da.case_date, 'yyyy-MM-dd') as caseDate,
        da.money as money,
        da.warning,
        da.case_deadline as caseDeadline,
        da.collect_hand as collectHand,
        da.order_no as orderNo,
        da.rmb as rmb,
        da.hkd as hkd,
        da.foreign_currency as foreignCurrency,
        da.gender as gender,
        da.name as name,
        da.card_no as cardNo,
        da.ident_no as identNo,
        da.ident_type as identType,
        da.odv as [collectionUser.id],
        da.collection_area as [collectionArea.id],
        da.summary,
        da.collect_result as collectInfo,
        da.m_val as mVal,
        da.commission_rate as commissionRate,
        da.commission_money as commissionMoney,
        da.home_tel_number as homeTelNumber,
        da.unit_tel_number as unitTelNumber,
        da.tel as tel,
        da.unit_name as unitName,
        da.new_case as newCase,
        da.case_user_position as caseUserPosition,
        da.case_user_depart as caseUserDepart,
        da.unit_address as unitAddress,
        da.unit_zip_code as unitZipCode,
        da.home_address as homeAddress,
        da.home_zip_code as homeZipCode,
        da.statement_address as statementAddress,
        da.statement_zip_code as statementZipCode,
        da.census_register_address as censusRegisterAddress,
        da.census_register_zip_code as censusRegisterZipCode,
        da.qq as qq,
        da.email as email,
        da.remark as selfInfo,
        da.birthday as birthday,
        da.age as age,
        da.province as [province.name],
        da.city as [city.name],
        da.county as [county.name],
        da.province as provinceName,
        da.city as cityName,
        da.county as countyName,
        da.expect_retire_case_date as expectRetireCaseDate,
        da.goods as goods,
        da.commercial_tenant as commercialTenant,
        da.archive_no as archiveNo,
        da.apply_order_no as applyOrderNo,
        da.social_security_computer_no as socialSecurityComputerNo,
        da.social_security_card_no as socialSecurityCardNo,
        da.bank as bank,
        da.account as account,
        da.account_name as accountName,
        da.card_type as cardType,
        da.principle as principle,
        da.loan_rate as loanRate,
        da.residual_principle as residualPrinciple,
        da.monthly_repayments as monthlyRepayments,
        da.minimum_payment as minimumPayment,
        da.credit_line as creditLine,
        da.fixed_quota as fixedQuota,
        da.default_level as defaultLevel,
        da.last_repay_money as lastRepayMoney,
        da.last_repay_date as lastRepayDate,
        da.last_consume_date as lastConsumeDate,
        da.last_withdraw_date as lastWithdrawDate,
        da.stop_card_date as stopCardDate,
        da.active_card_date as activeCardDate,
        da.bill_date as billDate,
        da.bill_cycle as billCycle,
        da.outstanding_amount as outstandingAmount,
        da.main_deputy_card as mainDeputyCard,
        da.deputy_card_user_name as deputyCardUserName,
        da.loan_date as loanDate,
        da.loan_deadline as loanDeadline,
        da.overdue_date as overdueDate,
        da.overdue_periods as overduePeriods,
        da.overdue_days as overdueDays,
        da.overdue_times as overdueTimes,
        da.entrust_periods as entrustPeriods,
        da.repay_deadline as repayDeadline,
        da.repaid_periods as repaidPeriods,
        da.loan_type as loanType,
        da.collection_type as collectionType,
        da.overdue_money as overdueMoney,
        da.overdue_principle as overduePrinciple,
        da.overdue_interest as overdueInterest,
        da.overdue_management_cost as overdueManagementCost,
        da.overdue_default_interest as overdueDefaultInterest,
        da.penalty as penalty,
        da.late_fee as lateFee,
        da.overrun_fee as overrunFee,
        da.bail as bail,
        da.currency_type as currencyType,
        da.last_collection_record as lastCollectionRecord,
        da.overdue_bill_time as overdueBillTime,
        da.contract_no as contractNo,
        da.over_days as overDays,
        da.dealer as dealer,
        da.apply_date as applyDate,
        da.repay_date as repayDate,
        da.policy_expiry_date as policyExpiryDate,
        da.card_price as cardPrice,
        da.card_model as cardModel,
        da.license as license,
        da.brand as brand,
        da.vin as vin,
        da.engine_no as engineNo,
        da.batch_no as batchNo,
        da.client as client,
        da.collect_area as collectArea,
        da.dept as dept,
        da.odv as odv,
        da.status as status,
        da.area as area,
        da.expect_time as expectTime,
        da.color as color,
        da.collect_status as collectStatus ,
        da.collect_date as collectDate,
        da.account_age as accountAge ,
        da.seq_no as seqNo,
        da.real_repay_date as realRepayDate ,
        dbo.fnFormatDate(da.distribute_time, 'yyyy-MM-dd HH:ii') as distributeTime,
        da.balance as balance,
        da.pro_repay_date as proPepayDate,
        da.distribute_history as distributeHistory,
        da.bank_amt as bankAmt,
        da.en_repay_amt as enRepayAmt,
        da.pro_repay_amt as proRepayAmt,
        da.collect_times as collectTimes,
        da.comment as comment,
        da.settle_flag as settleFlag,
        da.interest_date as interestDate,
        da.latest_overdue_money as latestOverdueMoney,
        da.real_return_time as realReturnTime,
        da.remark1,
        da.remark2,
        da.remark3,
        da.remark4,
        da.remark5,
        da.remark6,
        da.contactName1,
        da.contactIdentNo1,
        da.contactIdentType1,
        da.contactRelation1,
        da.contactHomeTel1,
        da.contactUnitTel1,
        da.contactMobile1,
        da.contactUnit1,
        da.contactAddress1,
        da.contactName2,
        da.contactIdentNo2,
        da.contactIdentType2,
        da.contactRelation2,
        da.contactHomeTel2,
        da.contactUnitTel2,
        da.contactMobile2,
        da.contactUnit2,
        da.contactAddress2,
        da.contactName3,
        da.contactIdentNo3,
        da.contactIdentType3,
        da.contactRelation3,
        da.contactHomeTel3,
        da.contactUnitTel3,
        da.contactMobile3,
        da.contactUnit3,
        da.contactAddress3,
        da.contactName4,
        da.contactIdentNo4,
        da.contactIdentType4,
        da.contactRelation4,
        da.contactHomeTel4,
        da.contactUnitTel4,
        da.contactMobile4,
        da.contactUnit4,
        da.contactAddress4,
        da.contactName5,
        da.contactIdentNo5,
        da.contactIdentType5,
        da.contactRelation5,
        da.contactHomeTel5,
        da.contactUnitTel5,
        da.contactMobile5,
        da.contactUnit5,
        da.contactAddress5,
        da.contactName6,
        da.contactIdentNo6,
        da.contactIdentType6,
        da.contactRelation6,
        da.contactHomeTel6,
        da.contactUnitTel6,
        da.contactMobile6,
        da.contactUnit6,
        da.contactAddress6
    </sql>

    <sql id="colSql">
        DISTINCT da.id as id,
        CONVERT(varchar(100), da.case_date, 23)  as caseDate,
        da.money as money,
        da.warning,
        da.case_deadline as caseDeadline,
        da.collect_hand as collectHand,
        da.rmb as rmb,
        da.hkd as hkd,
        da.foreign_currency as foreignCurrency,
        da.gender as gender,
        da.name as name,
        da.card_no as cardNo,
        da.ident_no as identNo,
        da.ident_type as identType,
        da.odv as [collectionUser.id],
        da.collection_area as [collectionArea.id],
        da.summary,
        da.collect_result as collectInfo,
        da.m_val as mVal,
        da.commission_rate as commissionRate,
        da.commission_money as commissionMoney,
        da.home_tel_number as homeTelNumber,
        da.unit_tel_number as unitTelNumber,
        da.tel as tel,
        da.unit_name as unitName,
        da.new_case as newCase,
        da.case_user_position as caseUserPosition,
        da.case_user_depart as caseUserDepart,
        da.unit_address as unitAddress,
        da.unit_zip_code as unitZipCode,
        da.home_address as homeAddress,
        da.home_zip_code as homeZipCode,
        da.statement_address as statementAddress,
        da.statement_zip_code as statementZipCode,
        da.census_register_address as censusRegisterAddress,
        da.census_register_zip_code as censusRegisterZipCode,
        da.qq as qq,
        da.email as email,
        da.remark as selfInfo,
        da.birthday as birthday,
        da.age as age,
        da.province as [province.name],
        da.city as [city.name],
        da.county as [county.name],
        da.expect_retire_case_date as expectRetireCaseDate,
        da.goods as goods,
        da.commercial_tenant as commercialTenant,
        da.archive_no as archiveNo,
        da.apply_order_no as applyOrderNo,
        da.social_security_computer_no as socialSecurityComputerNo,
        da.social_security_card_no as socialSecurityCardNo,
        da.bank as bank,
        da.account as account,
        da.account_name as accountName,
        da.card_type as cardType,
        da.principle as principle,
        da.loan_rate as loanRate,
        da.residual_principle as residualPrinciple,
        da.monthly_repayments as monthlyRepayments,
        da.minimum_payment as minimumPayment,
        da.credit_line as creditLine,
        da.fixed_quota as fixedQuota,
        da.default_level as defaultLevel,
        da.last_repay_money as lastRepayMoney,
        da.last_repay_date as lastRepayDate,
        da.last_consume_date as lastConsumeDate,
        da.last_withdraw_date as lastWithdrawDate,
        da.stop_card_date as stopCardDate,
        da.active_card_date as activeCardDate,
        da.bill_date as billDate,
        da.bill_cycle as billCycle,
        da.outstanding_amount as outstandingAmount,
        da.main_deputy_card as mainDeputyCard,
        da.deputy_card_user_name as deputyCardUserName,
        da.loan_date as loanDate,
        da.loan_deadline as loanDeadline,
        da.overdue_date as overdueDate,
        da.overdue_periods as overduePeriods,
        da.overdue_days as overdueDays,
        da.overdue_times as overdueTimes,
        da.entrust_periods as entrustPeriods,
        da.repay_deadline as repayDeadline,
        da.repaid_periods as repaidPeriods,
        da.loan_type as loanType,
        da.collection_type as collectionType,
        da.overdue_money as overdueMoney,
        da.overdue_principle as overduePrinciple,
        da.overdue_interest as overdueInterest,
        da.overdue_management_cost as overdueManagementCost,
        da.overdue_default_interest as overdueDefaultInterest,
        da.penalty as penalty,
        da.late_fee as lateFee,
        da.overrun_fee as overrunFee,
        da.bail as bail,
        da.currency_type as currencyType,
        da.last_collection_record as lastCollectionRecord,
        da.overdue_bill_time as overdueBillTime,
        da.contract_no as contractNo,
        da.over_days as overDays,
        da.dealer as dealer,
        da.apply_date as applyDate,
        da.repay_date as repayDate,
        da.policy_expiry_date as policyExpiryDate,
        da.card_price as cardPrice,
        da.card_model as cardModel,
        da.license as license,
        da.brand as brand,
        da.vin as vin,
        da.engine_no as engineNo,
        da.batch_no as batchNo,
        da.client as client,
        da.collect_area as collectArea,
        da.dept as dept,
        da.odv as odv,
        da.status as status,
        da.area as area,
        da.expect_time as expectTime,
        da.color as color,
        da.collect_status as collectStatus ,
        da.collect_date as collectDate,
        da.account_age as accountAge ,
        da.seq_no as seqNo,
        da.real_repay_date as realRepayDate ,
        CONVERT(varchar(100), da.distribute_time, 20)  as distributeTime,
        da.balance as balance,
        da.pro_repay_date as proPepayDate,
        da.distribute_history as distributeHistory,
        da.bank_amt as bankAmt,
        da.en_repay_amt as enRepayAmt,
        da.pro_repay_amt as proRepayAmt,
        da.collect_times as collectTimes,
        da.comment as comment,
        da.settle_flag as settleFlag,
        da.interest_date as interestDate,
        da.latest_overdue_money as latestOverdueMoney
    </sql>

    <sql id="topcolSql">
       DISTINCT  top 50  da.id as id,
        CONVERT(varchar(100), da.case_date, 23)  as caseDate,
        da.money as money,
        da.warning,
        da.case_deadline as caseDeadline,
        da.collect_hand as collectHand,
        da.rmb as rmb,
        da.hkd as hkd,
        da.foreign_currency as foreignCurrency,
        da.gender as gender,
        da.name as name,
        da.card_no as cardNo,
        da.ident_no as identNo,
        da.ident_type as identType,
        da.odv as [collectionUser.id],
        da.collection_area as [collectionArea.id],
        da.summary,
        da.collect_result as collectInfo,
        da.m_val as mVal,
        da.commission_rate as commissionRate,
        da.commission_money as commissionMoney,
        da.home_tel_number as homeTelNumber,
        da.unit_tel_number as unitTelNumber,
        da.tel as tel,
        da.unit_name as unitName,
        da.new_case as newCase,
        da.case_user_position as caseUserPosition,
        da.case_user_depart as caseUserDepart,
        da.unit_address as unitAddress,
        da.unit_zip_code as unitZipCode,
        da.home_address as homeAddress,
        da.home_zip_code as homeZipCode,
        da.statement_address as statementAddress,
        da.statement_zip_code as statementZipCode,
        da.census_register_address as censusRegisterAddress,
        da.census_register_zip_code as censusRegisterZipCode,
        da.qq as qq,
        da.email as email,
        da.remark as selfInfo,
        da.birthday as birthday,
        da.age as age,
        da.province as [province.name],
        da.city as [city.name],
        da.county as [county.name],
        da.expect_retire_case_date as expectRetireCaseDate,
        da.goods as goods,
        da.commercial_tenant as commercialTenant,
        da.archive_no as archiveNo,
        da.apply_order_no as applyOrderNo,
        da.social_security_computer_no as socialSecurityComputerNo,
        da.social_security_card_no as socialSecurityCardNo,
        da.bank as bank,
        da.account as account,
        da.account_name as accountName,
        da.card_type as cardType,
        da.principle as principle,
        da.loan_rate as loanRate,
        da.residual_principle as residualPrinciple,
        da.monthly_repayments as monthlyRepayments,
        da.minimum_payment as minimumPayment,
        da.credit_line as creditLine,
        da.fixed_quota as fixedQuota,
        da.default_level as defaultLevel,
        da.last_repay_money as lastRepayMoney,
        da.last_repay_date as lastRepayDate,
        da.last_consume_date as lastConsumeDate,
        da.last_withdraw_date as lastWithdrawDate,
        da.stop_card_date as stopCardDate,
        da.active_card_date as activeCardDate,
        da.bill_date as billDate,
        da.bill_cycle as billCycle,
        da.outstanding_amount as outstandingAmount,
        da.main_deputy_card as mainDeputyCard,
        da.deputy_card_user_name as deputyCardUserName,
        da.loan_date as loanDate,
        da.loan_deadline as loanDeadline,
        da.overdue_date as overdueDate,
        da.overdue_periods as overduePeriods,
        da.overdue_days as overdueDays,
        da.overdue_times as overdueTimes,
        da.entrust_periods as entrustPeriods,
        da.repay_deadline as repayDeadline,
        da.repaid_periods as repaidPeriods,
        da.loan_type as loanType,
        da.collection_type as collectionType,
        da.overdue_money as overdueMoney,
        da.overdue_principle as overduePrinciple,
        da.overdue_interest as overdueInterest,
        da.overdue_management_cost as overdueManagementCost,
        da.overdue_default_interest as overdueDefaultInterest,
        da.penalty as penalty,
        da.late_fee as lateFee,
        da.overrun_fee as overrunFee,
        da.bail as bail,
        da.currency_type as currencyType,
        da.last_collection_record as lastCollectionRecord,
        da.overdue_bill_time as overdueBillTime,
        da.contract_no as contractNo,
        da.over_days as overDays,
        da.dealer as dealer,
        da.apply_date as applyDate,
        da.repay_date as repayDate,
        da.policy_expiry_date as policyExpiryDate,
        da.card_price as cardPrice,
        da.card_model as cardModel,
        da.license as license,
        da.brand as brand,
        da.vin as vin,
        da.engine_no as engineNo,
        da.batch_no as batchNo,
        da.client as client,
        da.collect_area as collectArea,
        da.dept as dept,
        da.odv as odv,
        da.status as status,
        da.area as area,
        da.expect_time as expectTime,
        da.color as color,
        da.collect_status as collectStatus ,
        da.collect_date as collectDate,
        da.account_age as accountAge ,
        da.seq_no as seqNo,
        da.real_repay_date as realRepayDate ,
        CONVERT(varchar(100), da.distribute_time, 20)  as distributeTime,
        da.balance as balance,
        da.pro_repay_date as proPepayDate,
        da.distribute_history as distributeHistory,
        da.bank_amt as bankAmt,
        da.en_repay_amt as enRepayAmt,
        da.pro_repay_amt as proRepayAmt,
        da.collect_times as collectTimes,
        da.comment as comment,
        da.settle_flag as settleFlag,
        da.interest_date as interestDate,
        da.latest_overdue_money as latestOverdueMoney
    </sql>

    <update id="updateInterest" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">

        update data_case set interest_date =#{interestDate},latest_overdue_money=#{latestOverdueMoney} where id = #{id}

    </update>

    <!--插入数据信息-->
    <insert id="saveArchive" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT @@IDENTITY AS 'Identity'
        </selectKey>
        insert into data_case
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="batchNo != null">batch_no,</if>
            <if test="money != null">money,</if>
            <if test="balance != null">balance,</if>
            <if test="rate != null">rate,</if>
            <if test="remark != null">remark,</if>
            <if test="realReturnTime != null">real_return_time,</if>
            status,
            delete_flag,
            create_time,
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="batchNo != null">#{batchNo},</if>
            <if test="money != null">#{money},</if>
            <if test="balance != null">#{balance},</if>
            <if test="rate != null">#{rate},</if>
            <if test="remark != null">#{remark},</if>
            <if test="realReturnTime != null">#{real_return_time},</if>
            1,
            0,
            GETDATE(),
        </trim>
    </insert>

    <update id="updateArchive" parameterType="xyz.zaijushou.zhx.sys.entity.DataArchiveEntity">
        update data_case
        set
        <trim suffixOverrides=",">
            <if test="money != null">money = #{money},</if>
            <if test="balance != null">balance = #{balance},</if>
            <if test="status != null">status = #{status},</if>
        </trim>
        where
        id = #{id}
    </update>

    <!--通过Id删除数据信息-->
    <delete id="deleteById" parameterType="java.lang.Integer">
        update data_case set delete_flag =1
        where id = #{id}
    </delete>

    <!--通过Id删除数据信息-->
    <delete id="deleteByIds" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set delete_flag =1
        where id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <!--通过Id删除数据信息-->
    <delete id="deleteByBatch" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set delete_flag =1
        where batch_no = #{batchNo}
    </delete>

    <select id="pageDataCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        id,money,balance,remark,status,create_time as createTime
        from data_case and delete_flag=0
        <where>
            <trim suffixOverrides=",">
                <if test="remark != null and remark!=''">
                    remark like dbo.CONCAT('%',#{remark},'%')
                </if>
            </trim>
        </where>
    </select>

    <!--数据模块-管理列表查询-->
    <select id="pageCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
               <!--
               da.id, da.batch_no as batchNo,da.client,da.collect_area as collectArea,da.dept,da.odv,da.status,da.area,da.expect_time as expectTime,da.color,
        da.collect_status as collectStatus , da.collect_date as collectDate,  da.account_age as accountAge ,da.seq_no as seqNo,da.case_date as caseDate,da.collect_hand as collectHand,
        da.real_repay_date as realRepayDate ,da.name as name ,da.card_no as cardNo,da.ident_no as identNo,dbo.fnFormatDate(da.distribute_time,'yyyy-MM-dd') as distributeTime,
        da.money as money,da.balance as balance,da.over_days as overDays,da.pro_repay_date as proPepayDate,da.distribute_history as distributeHistory,
        da.bank_amt as bankAmt,da.en_repay_amt as enRepayAmt,da.pro_repay_amt as proRepayAmt,da.comment,da.area,da.pro_repay_amt as proRepayAmt
        -->
        <include refid="colSql"/>
        from data_case da LEFT JOIN data_collection dc on da.id = dc.case_id
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and da.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="nameFlag != null and nameFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overDays != null and overDays!=''">
                    and da.overdue_days = #{overDays}
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and dc.collect_info = #{collectInfo}
                </if>
                <if test="dept != null and dept!=''">
                    and da.dept = #{dept}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatus != null and collectStatus!=''">
                    and dc.collect_status = #{collectStatus}
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}  ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}  ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
        order by ${orderBy} ${sort}
    </select>

    <!--数据模块-管理列表查询-->
    <select id="pageCaseMangeList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        da.id, da.batch_no as batchNo,da.client,da.collect_area as collectArea,da.dept,da.odv,da.status,da.area,da.expect_time as expectTime,da.color,
         da.collect_status as collectStatus , da.collect_date as collectDate,da.collect_date as collectTime,  da.account_age as accountAge ,da.seq_no as seqNo,CONVERT(varchar(100), da.case_date, 23) as caseDate,da.collect_hand as collectHand,
         da.real_repay_date as realRepayDate ,da.name as name ,da.card_no as cardNo,da.ident_no as identNo, CONVERT(varchar(100), da.distribute_time, 23) as distributeTime,
         da.money as money,da.balance as balance,da.over_days as overDays,da.pro_repay_date as proPepayDate,da.distribute_history as distributeHistory,
         da.bank_amt as bankAmt,da.en_repay_amt as enRepayAmt,da.pro_repay_amt as proRepayAmt,da.comment,collect_result as collectInfo, da.odv as [collectionUser.id],
        da.collect_times as collectTimes,da.leave_Days as leaveDays,da.principle,da.latest_overdue_money as latestOverdueMoney,da.overdue_date as overdueDate,da.overdue_days as overdueDays
        from data_case da
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and da.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>

                <if test="applyOrderNoFlag != null and applyOrderNoFlag != ''">
                    and da.apply_order_no in
                    <foreach item="item" index="index" collection="applyOrderNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>


                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <!--<if test="overDays != null and overDays!=''">
                    and da.overdue_days = #{overDays}
                </if>-->
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>

                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>
                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>

                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        ${item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

            </trim>
        </where>
        order by ${orderBy} ${sort}
    </select>

    <select id="pageBatchBoundsCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select id, batch_no as batchNo,client,collect_area as collectArea,dept,odv,status,area,expect_time as expectTime,color,new_case as newCase, odv as [collectionUser.id],
        collect_status as collectStatus , collect_date as collectDate, account_age as accountAge ,seq_no as seqNo,dbo.fnFormatDate(case_date, 'yyyy-MM-dd') as caseDate,collect_hand as collectHand,
        real_repay_date as realRepayDate ,name as name ,card_no as cardNo,ident_no as identNo,dbo.fnFormatDate(distribute_time,'yyyy-MM-dd  HH:ii') as distributeTime,
        money as money,balance as balance,overdue_days as overDays,pro_repay_date as proPepayDate,distribute_history as distributeHistory,collect_result as collectInfo,
        bank_amt as bankAmt,en_repay_amt as enRepayAmt,comment,pro_repay_amt as proRepayAmt,collect_times as collectTimes,leave_Days as leaveDays,principle,latest_overdue_money as latestOverdueMoney,overdue_date as overdueDate,overdue_days as overdueDays
         from data_case where ident_no in (
        select   da.ident_no
        from data_case da LEFT JOIN data_collection dc on da.id = dc.case_id
        <where>
            da.delete_flag = 0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and da.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>

                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>

                <if test="applyOrderNoFlag != null and applyOrderNoFlag != ''">
                    and da.apply_order_no in
                    <foreach item="item" index="index" collection="applyOrderNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!='' and client!=null and client.size()>0 ">
                    and da.client in
                    <foreach item="item" index="index" collection="client" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>


                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and dc.collect_info = #{collectInfo}
                </if>

                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}  ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}   ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}  ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>


                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>


                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>
            </trim>
        </where>
        order by ${orderBy} ${sort}
        )
    </select>


    <!--催收模块-我的案件-列表查询-->
    <select id="pageCaseInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        da.collect_status as collectStatus , da.account_age as accountAge ,da.seq_no as seqNo,dbo.fnFormatDate(da.case_date, 'yyyy-MM-dd') as caseDate,
        da.real_repay_date as realRepayDate ,da.name as name ,da.card_no as cardo,da.ident_no as identNo,
        da.money as money,da.balance as balance,da.over_days as overDays,da.pro_repay_date as proPepayDate,
        da.bank_amt as bankAmt,dc.collect_info as collectInfo
        from data_case da LEFT JOIN data_collection dc on da.id = dc.case_id
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="client != null and client!=''">
                    and da.client = #{client}
                </if>
                <if test="batchNo != null and batchNo!=''">
                    and da.batch_no = #{batchNo}
                </if>
                <if test="seqNo != null and seqNo!=''">
                    and da.seq_no = #{seqNo}
                </if>
                <if test="name != null and name!=''">
                    and da.name = #{name}
                </if>
                <if test="identNo != null and identNo!=''">
                    and da.ident_no = #{identNo}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="account != null and account!=''">
                    and da.account = #{account}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="collectStatus != null and collectStatus!=''">
                    and da.collect_status = #{collectStatus}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="cardNo != null and cardNo!=''">
                    and da.card_no = #{cardNo}
                </if>
                <if test="archiveNo != null and archiveNo!=''">
                    and da.archive_no = #{archiveNo}
                </if>
                <if test="newCase != null and newCase!=''">
                    and da.new_case = #{newCase}
                </if>
                <if test="repayStatus != null and repayStatus!=''">
                    and da.repay_status = #{repayStatus}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="reportStatus != null and reportStatus!=''">
                    and da.report_status = #{reportStatus}
                </if>

                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.money, 'yyyy-MM-dd')>=  #{moneyStart}   ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.money, 'yyyy-MM-dd')<=  #{moneyEnd}   ]]>
                </if>

                <if test="realRepayDateStart != null and realRepayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realRepayDateStart}  ]]>
                </if>
                <if test="realRepayDateEnd != null and realRepayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realRepayDateEnd}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>

    <!--统计金额-->
    <select id="sumCaseMoney" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        id
        from data_case
        <where>
            delete_flag=0
            <trim suffixOverrides=",">
                <if test="remark != null and remark!=''">
                    and remark like dbo.CONCAT('%',#{remark},'%')
                </if>
            </trim>
        </where>
    </select>

    <update id="watchDetail" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
         update data_case set distribute_status=3
        where id = #{id}
    </update>
    <update id="sendOdv" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set odv = #{odv},dept=#{dept},distribute_history=distribute_history+#{distributeHistory},distribute_time=GETDATE(),distribute_status=1
        where id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            ${item}
        </foreach>
    </update>

    <update id="sendSingleOdv" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set odv = #{odv},dept=#{dept},distribute_history=distribute_history+#{distributeHistory},distribute_time=GETDATE(),distribute_status=1
        where id = #{id}
    </update>

    <update id="updateStatus" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set status = #{status},return_time=#{returnTime},real_return_time = #{realReturnTime}
        where id = #{id}
    </update>

    <update id="addComment" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set comment = #{comment}
        where id = #{id}
    </update>

    <update id="addWarning" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set warning = #{warning}
        where id = #{id}
    </update>

    <select id="lastCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  t.id,t.name,t.seq_no as seqNo  from data_case t where id =#{id}
    </select>

    <!--<select id="lastCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        with temp ( [id], [parent_id])
        as
        (
        select id, parent_id
        from sys_organization
        where [parent_id] = (SELECT department FROM sys_user WHERE id =  #{odv})
        union all
        select a.id, a.parent_id
        from sys_organization a
        inner join temp on a.[parent_id] = temp.[id]
        )

        select top 1  t.id,t.name,t.seq_no as seqNo  from data_case t
       <![CDATA[     where id > #{id} ]]>  and ( odv IN (SELECT  DISTINCT b.id FROM temp a LEFT JOIN sys_user b ON b.department = a.id WHERE b.id IS NOT NULL) OR odv = #{odv})
         order by id asc
    </select>-->
    <select id="nextCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        with temp ( [id], [parent_id])
        as
        (
        select id, parent_id
        from sys_organization
        where [parent_id] = (SELECT department FROM sys_user WHERE id =  #{odv})
        union all
        select a.id, a.parent_id
        from sys_organization a
        inner join temp on a.[parent_id] = temp.[id]
        )

        select top 1 t.id,t.name,t.seq_no as seqNo  from data_case t
        <![CDATA[     where id < #{id} ]]> and ( odv IN (SELECT  DISTINCT b.id FROM temp a LEFT JOIN sys_user b ON b.department = a.id WHERE b.id IS NOT NULL) OR odv = #{odv})
        order by id desc
    </select>


    <update id="updateComment" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set
        <trim suffixOverrides=",">
            <if test="comment != null">comment = #{comment},</if>
            <if test="color != null">color = #{color},</if>
        </trim>
        where seq_no = #{seqNo}
    </update>

    <update id="addColor" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set color = #{color}
        where id = #{id}
    </update>
    <update id="addImportant" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set important = #{important}
        where id = #{id}
    </update>
    <update id="addCollectStatus" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_status = #{collectStatus}
        where id = #{id}
    </update>
    <update id="addCollectArea" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_area = #{collectArea}
        where id = #{id}
    </update>
    <update id="addMValue" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set m_val = #{mVal}
        where id = #{id}
    </update>
    <update id="addSynergy" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set synergy = 2,synergy_date = GETDATE(),synergy_context =#{synergyContext},synergy_type=#{synergyType}
        where id = #{id}
    </update>
    <!--数据模块-按照查询分配业务员-->
    <select id="sendOdvByProperty" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          update data_case set odv = #{odv},dept=#{dept},distribute_history=distribute_history+#{distributeHistory},distribute_time=GETDATE(),distribute_status=1
          where id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            ${item}
        </foreach>
    </select>

    <!--催收模块-主管协催-列表查询-->
    <select id="pageSynergyInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
         id, synergy_context as synergyContext,seq_no as seqNo,odv,dbo.fnFormatDate(synergy_date,'yyyy-MM-dd HH:ii:ss') as synergyDate
        from data_case
        <where>
            synergy = #{synergy}
            <trim suffixOverrides=",">
                <if test="dept != null and dept!=''">
                    and dept = #{dept}
                </if>
                <if test="odv != null and odv!=''">
                    and odv = #{odv}
                </if>
                <if test="client != null and client!=''">
                    and client = #{client}
                </if>
                <if test="synergyStartTime != null and synergyStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(synergy_date, 'yyyy-MM-dd')>=  #{synergyStartTime}   ]]>
                </if>
                <if test="synergyEndTime != null and synergyEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(synergy_date, 'yyyy-MM-dd')<=  #{synergyEndTime}   ]]>
                </if>
            </trim>
        </where>
    </select>

    <select id="countSynergyInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="java.lang.Integer">
        select
        count(id) as num
        from data_case
        <where>
            synergy = #{synergy} and  delete_flag=0
            <trim suffixOverrides=",">
                <if test="dept != null and dept!=''">
                    and dept = #{dept}
                </if>
                <if test="odv != null and odv!=''">
                    and odv = #{odv}
                </if>
                <if test="client != null and client!=''">
                    and client = #{client}
                </if>
                <if test="synergyStartTime != null and synergyStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(synergy_date, 'yyyy-MM-dd')>=  #{synergyStartTime}  ]]>
                </if>
                <if test="synergyEndTime != null and synergyEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(synergy_date, 'yyyy-MM-dd')<=  #{synergyEndTime}   ]]>
                </if>
            </trim>
        </where>
    </select>

    <update id="updateSynergy" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set synergy = #{synergy}
        where id = #{id}
    </update>



    <select id="pageCaseTel" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        t.id,t.seq_no as seqNo,t.name,t.card_no as cardNo,t.money,CONVERT(varchar(100), t.case_date, 23)  as caseDate,t.collect_status as collectStatus,
        CONVERT(varchar(100), t.collect_date, 23) as collectDate,
        t.pro_repay_amt as proRepayAmt,t.en_repay_amt as enRepayAmt,t.account_age as accountAge,t.odv,t.comment
        from data_case t    LEFT  JOIN data_case_tel d on t.id = d.case_id
        <where>
            <trim suffixOverrides=",">
                <if test="clientFlag != null and clientFlag!='' and queryMethod=='1'.toString()" >
                    and t.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="name != null and name!='' and queryMethod=='1'.toString()">
                    and t.name = #{name}
                </if>
                <if test="cardNo != null and cardNo!='' and queryMethod=='1'.toString()">
                    and t.card_no = #{cardNo}
                </if>
                <if test="unitName != null and unitName!='' and queryMethod=='1'.toString()">
                    and t.unit_name = #{unitName}
                </if>
                <if test="identNo != null and identNo!='' and queryMethod=='1'.toString()">
                    and t.ident_no = #{identNo}
                </if>
                <if test="address != null and address!='' and queryMethod=='1'.toString()">
                    and t.home_address = #{address}
                </if>
                <if test="tel != null and tel!='' and queryMethod=='1'.toString()">
                    and d.tel = #{tel}
                </if>
                <if test="clientFlag != null and clientFlag!='' and queryMethod=='2'.toString()" >
                    and t.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="name != null and name!='' and queryMethod=='2'.toString()">
                    AND t.name like  '%${name}%'
                </if>
                <if test="cardNo != null and cardNo!='' and queryMethod=='2'.toString()">
                    AND t.card_no  like  '%${cardNo}%'
                </if>
                <if test="unitName != null and unitName!='' and queryMethod=='2'.toString()">
                    AND t.unit_name  like '%${unitName}%'
                </if>
                <if test="identNo != null and identNo!='' and queryMethod=='2'.toString()">
                    AND t.ident_no like '%${identNo}%'
                </if>
                <if test="address != null and address!='' and queryMethod=='2'.toString()">
                    AND t.home_address like '%${address}%'
                </if>
                <if test="tel != null and tel!='' and queryMethod=='2'.toString()">
                    AND d.tel like '%${tel}%'
                </if>
            </trim>
        </where>
        order by ${orderBy} ${sort}
    </select>

    <select id="countCaseTel" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="java.lang.Integer">
        select
        count(id) as sum
        from data_case t LEFT JOIN data_case_tel l on t.id = l.case_id
        LEFT  JOIN data_case_address d on t.id = d.case_id
        <where>
            <trim suffixOverrides=",">
                <if test="client != null and client!='' and queryMethod='1'">
                    and t.client = #{client}
                </if>
                <if test="name != null and name!='' and queryMethod='1'">
                    and t.name = #{name}
                </if>
                <if test="cardNo != null and cardNo!='' and queryMethod='1'">
                    and t.card_no = #{cardNo}
                </if>
                <if test="unitName != null and unitName!='' and queryMethod='1'">
                    and t.unit_name = #{unitName}
                </if>
                <if test="identNo != null and identNo!='' and queryMethod='1'">
                    and t.ident_no = #{identNo}
                </if>
                <if test="address != null and address!='' and queryMethod='1'">
                    and d.address = #{address}
                </if>
                <if test="tel != null and tel!='' and queryMethod='1'">
                    and l.address = #{tel}
                </if>

                <if test="client != null and client!='' and queryMethod='2'">
                    AND t.client = #{client}
                </if>
                <if test="name != null and name!='' and queryMethod='2'">
                    AND t.name = #{name}
                </if>
                <if test="cardNo != null and cardNo!='' and queryMethod='2'">
                    AND t.card_no = #{cardNo}
                </if>
                <if test="unitName != null and unitName!='' and queryMethod='2'">
                    AND t.unit_name = #{unitName}
                </if>
                <if test="identNo != null and identNo!='' and queryMethod='2'">
                    AND t.ident_no = #{identNo}
                </if>
                <if test="address != null and address!='' and queryMethod='2'">
                    AND d.address = #{address}
                </if>
                <if test="tel != null and tel!='' and queryMethod='2'">
                    AND l.tel  = #{tel}
                </if>
            </trim>
        </where>
    </select>



    <select id="listAllCaseInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select da.id,da.card_no as cardNo,
        da.collect_status as collectStatus , da.account_age as accountAge ,da.seq_no as seqNo,dbo.fnFormatDate(da.case_date, 'yyyy-MM-dd') as caseDate,
        da.real_repay_date as realRepayDate ,da.name as name ,da.ident_no as identNo,
        da.money as money,da.balance as balance,da.over_days as overDays,da.pro_repay_date as proPepayDate,
        da.bank_amt as bankAmt,da.batch_no as batchNo
        from data_case da
        where delete_flag = 0
        <if test="id != null and id!=''">
            and da.id = #{id}
        </if>
    </select>

    <select id="listSameAllCaseInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  id from data_case where batch_no = #{batchNo} and ident_no = #{identNo}
    </select>

    <select id="listInitAllCaseInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.id,da.card_no as cardNo,da.odv,
        da.collect_status as collectStatus , da.account_age as accountAge ,da.seq_no as seqNo,dbo.fnFormatDate(da.case_date, 'yyyy-MM-dd') as caseDate,
        da.real_repay_date as realRepayDate ,da.name as name ,da.card_no as cardo,da.ident_no as identNo,
        da.money as money,da.balance as balance,da.over_days as overDays,da.pro_repay_date as proPepayDate,
        da.bank_amt as bankAmt,da.batch_no as batchNo
        from data_case da
        where da.delete_flag = 0  <![CDATA[   and da.id>#{id}  and  da.id <= #{maxId}]]>
    </select>

    <select id="listBySeqNoSet" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
            id as id,
            seq_no as seqNo,odv
        from data_case
        where delete_flag = 0
        and seq_no in
              <foreach collection="seqNoSet" open="(" close=")" separator="," item="item">
                  #{item}
              </foreach>
    </select>

    <update id="updateBySeqNo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
    update data_case
    <set >
        <trim suffixOverrides=",">
            <if test="realReturnTime != null and realReturnTime != ''">
                real_return_time = #{realReturnTime},
            </if>
            <if test="caseDate != null and caseDate != ''">
                case_date = #{caseDateD},
            </if>
            <if test="money != null and money != ''">
                money = #{money},
            </if>
            <if test="businessType != null and businessType != ''">
                business_type = #{businessType},
            </if>
            <if test="caseDeadline != null and caseDeadline != ''">
                case_deadline = #{caseDeadline},
            </if>
            <if test="collectHand != null and collectHand != ''">
                collect_hand = #{collectHand},
            </if>
            <if test="rmb != null and rmb != ''">
                rmb = #{rmb},
            </if>
            <if test="hkd != null and hkd != ''">
                hkd = #{hkd},
            </if>
            <if test="foreignCurrency != null and foreignCurrency != ''">
                foreign_currency = #{foreignCurrency},
            </if>
            <if test="gender != null and gender != ''">
                gender = #{gender},
            </if>
            <if test="name != null and name != ''">
                name = #{name},
            </if>
            <if test="cardNo != null and cardNo != ''">
                card_no = #{cardNo},
            </if>
            <if test="identNo != null and identNo != ''">
                ident_no = #{identNo},
            </if>
            <if test="identType != null and identType != ''">
                ident_type = #{identType},
            </if>

            <if test="collectionUser != null and collectionUser.id != null">
                odv = #{collectionUser.id},
            </if>
            <if test="dept != null and dept !=''">
                dept = #{dept},
            </if>
            <if test="distributeHistory != null and distributeHistory !=''">
                distribute_history = distribute_history+#{distributeHistory},
            </if>
            <if test="distributeStatus != null">
                distribute_status = #{distributeStatus},
            </if>
            <if test="distributeDate != null">
                distribute_time = #{distributeDate},
            </if>
            <if test="collectionArea != null and collectionArea.id != null">
                collection_area = #{collectionArea.id},
            </if>
            <if test="collectInfo != null and collectInfo != ''">
                collect_result = #{collectInfo},
            </if>
            <if test="mVal != null and mVal != ''">
                m_val = #{mVal},
            </if>
            <if test="commissionRate != null and commissionRate != ''">
                commission_rate = #{commissionRate},
            </if>
            <if test="commissionMoney != null and commissionMoney != ''">
                commission_money = #{commissionMoney},
            </if>
            <if test="homeTelNumber != null and homeTelNumber != ''">
                home_tel_number = #{homeTelNumber},
            </if>
            <if test="unitTelNumber != null and unitTelNumber != ''">
                unit_tel_number = #{unitTelNumber},
            </if>
            <if test="tel != null and tel != null">
                tel = #{tel},
            </if>
            <if test="unitTelNumber != null and unitTelNumber != ''">
                unit_name = #{unitName},
            </if>
            <if test="caseUserPosition != null and caseUserPosition != ''">
                case_user_position = #{caseUserPosition},
            </if>
            <if test="caseUserDepart != null and caseUserDepart != ''">
                case_user_depart = #{caseUserDepart},
            </if>
            <if test="unitAddress != null and unitAddress != ''">
                unit_address = #{unitAddress},
            </if>
            <if test="unitZipCode != null and unitZipCode != ''">
                unit_zip_code = #{unitZipCode},
            </if>
            <if test="homeAddress != null and homeAddress != ''">
                home_address = #{homeAddress},
            </if>
            <if test="homeZipCode != null and homeZipCode != ''">
                home_zip_code = #{homeZipCode},
            </if>
            <if test="statementAddress != null and statementAddress != ''">
                statement_address = #{statementAddress},
            </if>
            <if test="statementZipCode != null and statementZipCode != ''">
                statement_zip_code = #{statementZipCode},
            </if>
            <if test="censusRegisterAddress != null and censusRegisterAddress != ''">
                census_register_address = #{censusRegisterAddress},
            </if>
            <if test="censusRegisterZipCode != null and censusRegisterZipCode != ''">
                census_register_zip_code = #{censusRegisterZipCode},
            </if>
            <if test="qq != null and qq != ''">
                qq = #{qq},
            </if>
            <if test="email != null and email != ''">
                email = #{email},
            </if>
            <if test="birthday != null and birthday != ''">
                birthday = #{birthday},
            </if>
            <if test="age != null and age != ''">
                age = #{age},
            </if>
            <if test="province != null and province.name != null">
                province = #{province.name},
            </if>
            <if test="city != null and city.name != null">
                city = #{city.name},
            </if>
            <if test="county != null and county.name != null">
                county = #{county.name},
            </if>
            <if test="expectTime != null and expectTime != ''">
                expect_time = #{expectTime},
            </if>
            <if test="goods != null and goods != ''">
                goods = #{goods},
            </if>
            <if test="commercialTenant != null and commercialTenant != ''">
                commercial_tenant = #{commercialTenant},
            </if>
            <if test="archiveNo != null and archiveNo != ''">
                archive_no = #{archiveNo},
            </if>
            <if test="applyOrderNo != null and applyOrderNo != ''">
                apply_order_no = #{applyOrderNo},
            </if>
            <if test="socialSecurityComputerNo != null and socialSecurityComputerNo != ''">
                social_security_computer_no = #{socialSecurityComputerNo},
            </if>
            <if test="socialSecurityCardNo != null and socialSecurityCardNo != ''">
                social_security_card_no = #{socialSecurityCardNo},
            </if>
            <if test="bank != null and bank != ''">
                bank = #{bank},
            </if>
            <if test="accountNo != null and accountNo != ''">
                account_no = #{accountNo},
            </if>
            <if test="accountName != null and accountName != ''">
                account_name = #{accountName},
            </if>
            <if test="cardType != null and cardType != ''">
                card_type = #{cardType},
            </if>
            <if test="principle != null and principle != ''">
                principle = #{principle},
            </if>
            <if test="loanRate != null and loanRate != ''">
                loan_rate = #{loanRate},
            </if>
            <if test="residualPrinciple != null and residualPrinciple != ''">
                residual_principle = #{residualPrinciple},
            </if>
            <if test="monthlyRepayments != null and monthlyRepayments != ''">
                monthly_repayments = #{monthlyRepayments},
            </if>
            <if test="minimumPayment != null and minimumPayment != ''">
                minimum_payment = #{minimumPayment},
            </if>
            <if test="creditLine != null and creditLine != ''">
                credit_line = #{creditLine},
            </if>
            <if test="fixedQuota != null and fixedQuota != ''">
                fixed_quota = #{fixedQuota},
            </if>
            <if test="defaultLevel != null and defaultLevel != ''">
                default_level = #{defaultLevel},
            </if>
            <if test="lastRepayMoney != null and lastRepayMoney != ''">
                last_repay_money = #{lastRepayMoney},
            </if>
            <if test="lastRepayDate != null">
                last_repay_date = #{lastRepayDate},
            </if>
            <if test="lastConsumeDate != null">
                last_consume_date = #{lastConsumeDate},
            </if>
            <if test="lastWithdrawDate != null">
                last_withdraw_date = #{lastWithdrawDate},
            </if>
            <if test="stopCardDate != null">
                stop_card_date = #{stopCardDate},
            </if>
            <if test="activeCardDate != null ">
                active_card_date = #{activeCardDate},
            </if>
            <if test="billDate != null and billDate != ''">
                bill_date = #{billDate},
            </if>
            <if test="billCycle != null and billCycle != ''">
                bill_cycle = #{billCycle},
            </if>
            <if test="outstandingAmount != null and outstandingAmount != ''">
                outstanding_amount = #{outstandingAmount},
            </if>
            <if test="mainDeputyCard != null and mainDeputyCard != ''">
                main_deputy_card = #{mainDeputyCard},
            </if>
            <if test="deputyCardUserName != null and deputyCardUserName != ''">
                deputy_card_user_name = #{deputyCardUserName},
            </if>
            <if test="loanDate != null ">
                loan_date = #{loanDate},
            </if>
            <if test="loanDeadline != null">
                loan_deadline = #{loanDeadline},
            </if>
            <if test="overdueDate != null ">
                overdue_date = #{overdueDate},
            </if>
            <if test="overduePeriods != null and overduePeriods != ''">
                overdue_periods = #{overduePeriods},
            </if>
            <if test="overdueDays != null">
                overdue_days = #{overdueDays},
            </if>
            <if test="overdueTimes != null and overdueTimes != ''">
                overdue_times = #{overdueTimes},
            </if>
            <if test="entrustPeriods != null and entrustPeriods != ''">
                entrust_periods = #{entrustPeriods},
            </if>
            <if test="repayDeadline != null">
                repay_deadline = #{repayDeadline},
            </if>
            <if test="repaidPeriods != null and repaidPeriods != ''">
                repaid_periods = #{repaidPeriods},
            </if>
            <if test="loanType != null and loanType != ''">
                loan_type = #{loanType},
            </if>
            <if test="collectionType != null and collectionType != ''">
                collection_type = #{collectionType},
            </if>
            <if test="overdueMoney != null and overdueMoney != ''">
                overdue_money = #{overdueMoney},
            </if>
            <if test="overduePrinciple != null and overduePrinciple != ''">
                overdue_principle = #{overduePrinciple},
            </if>
            <if test="overdueInterest != null and overdueInterest != ''">
                overdue_interest = #{overdueInterest},
            </if>
            <if test="overdueManagementCost != null and overdueManagementCost != ''">
                overdue_management_cost = #{overdueManagementCost},
            </if>
            <if test="overdueDefaultInterest != null and overdueDefaultInterest != ''">
                overdue_default_interest = #{overdueDefaultInterest},
            </if>
            <if test="penalty != null and penalty != ''">
                penalty = #{penalty},
            </if>
            <if test="lateFee != null and lateFee != ''">
                late_fee = #{lateFee},
            </if>
            <if test="overrunFee != null and overrunFee != ''">
                overrun_fee = #{overrunFee},
            </if>
            <if test="bail != null and bail != ''">
                bail = #{bail},
            </if>
            <if test="currencyType != null and currencyType != ''">
                currency_type = #{currencyType},
            </if>
            <if test="lastCollectionRecord != null and lastCollectionRecord != ''">
                last_collection_record = #{lastCollectionRecord},
            </if>
            <if test="overdueBillTime != null and overdueBillTime != ''">
                overdue_bill_time = #{overdueBillTime},
            </if>
            <if test="contractNo != null and contractNo != ''">
                contract_no = #{contractNo},
            </if>
            <if test="overDays != null and overDays != ''">
                over_days = #{overDays},
            </if>
            <if test="dealer != null and dealer != ''">
                dealer = #{dealer},
            </if>
            <if test="applyDate != null">
                apply_date = #{applyDate},
            </if>
            <if test="repayDate != null and repayDate != ''">
                repay_date = #{repayDate},
            </if>
            <if test="policyExpiryDate != null">
                policy_expiry_date = #{policyExpiryDate},
            </if>
            <if test="cardPrice != null and cardPrice != ''">
                card_price = #{cardPrice},
            </if>
            <if test="cardModel != null and cardModel != ''">
                card_model = #{cardModel},
            </if>
            <if test="license != null and license != ''">
                license = #{license},
            </if>
            <if test="brand != null and brand != ''">
                brand = #{brand},
            </if>
            <if test="vin != null and vin != ''">
                vin = #{vin},
            </if>
            <if test="engineNo != null and engineNo != ''">
                engine_no = #{engineNo},
            </if>
            <if test="contactName1 != null and contactName1 != ''">
                contactName1 = #{contactName1},
            </if>
            <if test="contactIdentNo1 != null and contactIdentNo1 != ''">
                contactIdentNo1 = #{contactIdentNo1},
            </if>
            <if test="contactIdentType1 != null and contactIdentType1 != ''">
                contactIdentType1 = #{contactIdentType1},
            </if>
            <if test="contactRelation1 != null and contactRelation1 != ''">
                contactRelation1 = #{contactRelation1},
            </if>
            <if test="contactHomeTel1 != null and contactHomeTel1 != ''">
                contactHomeTel1 = #{contactHomeTel1},
            </if>
            <if test="contactUnitTel1 != null and contactUnitTel1 != ''">
                contactUnitTel1 = #{contactUnitTel1},
            </if>
            <if test="contactMobile1 != null and contactMobile1 != ''">
                contactMobile1 = #{contactMobile1},
            </if>
            <if test="contactUnit1 != null and contactUnit1 != ''">
                contactUnit1 = #{contactUnit1},
            </if>
            <if test="contactAddress1 != null and contactAddress1 != ''">
                contactAddress1 = #{contactAddress1},
            </if>
            <if test="contactName2 != null and contactName2 != ''">
                contactName2 = #{contactName2},
            </if>
            <if test="contactIdentNo2 != null and contactIdentNo2 != ''">
                contactIdentNo2 = #{contactIdentNo2},
            </if>
            <if test="contactIdentType2 != null and contactIdentType2 != ''">
                contactIdentType1 = #{contactIdentType1},
            </if>
            <if test="contactRelation2 != null and contactRelation2 != ''">
                contactRelation2 = #{contactRelation2},
            </if>
            <if test="contactHomeTel2 != null and contactHomeTel2 != ''">
                contactHomeTel2 = #{contactHomeTel2},
            </if>
            <if test="contactUnitTel2 != null and contactUnitTel2 != ''">
                contactUnitTel2 = #{contactUnitTel2},
            </if>
            <if test="contactMobile2 != null and contactMobile2 != ''">
                contactMobile2 = #{contactMobile2},
            </if>
            <if test="contactUnit2 != null and contactUnit2 != ''">
                contactUnit2 = #{contactUnit2},
            </if>
            <if test="contactAddress2 != null and contactAddress2 != ''">
                contactAddress2 = #{contactAddress2},
            </if>
            <if test="contactName3 != null and contactName3 != ''">
                contactName3 = #{contactName3},
            </if>
            <if test="contactIdentNo3 != null and contactIdentNo3 != ''">
                contactIdentNo3 = #{contactIdentNo3},
            </if>
            <if test="contactIdentType3 != null and contactIdentType3 != ''">
                contactIdentType3 = #{contactIdentType3},
            </if>
            <if test="contactRelation3 != null and contactRelation3 != ''">
                contactRelation3 = #{contactRelation3},
            </if>
            <if test="contactHomeTel3 != null and contactHomeTel3 != ''">
                contactHomeTel3 = #{contactHomeTel3},
            </if>
            <if test="contactUnitTel3 != null and contactUnitTel3 != ''">
                contactUnitTel3 = #{contactUnitTel3},
            </if>
            <if test="contactMobile3 != null and contactMobile3 != ''">
                contactMobile3 = #{contactMobile3},
            </if>
            <if test="contactUnit3 != null and contactUnit3 != ''">
                contactUnit3 = #{contactUnit3},
            </if>
            <if test="contactAddress3 != null and contactAddress3 != ''">
                contactAddress3 = #{contactAddress3},
            </if>
            <if test="contactName4 != null and contactName4 != ''">
                contactName4 = #{contactName4},
            </if>
            <if test="contactIdentNo4 != null and contactIdentNo4 != ''">
                contactIdentNo4 = #{contactIdentNo4},
            </if>
            <if test="contactIdentType4 != null and contactIdentType4 != ''">
                contactIdentType4 = #{contactIdentType4},
            </if>
            <if test="contactRelation4 != null and contactRelation4 != ''">
                contactRelation4 = #{contactRelation4},
            </if>
            <if test="contactHomeTel4 != null and contactHomeTel4 != ''">
                contactHomeTel4 = #{contactHomeTel4},
            </if>
            <if test="contactUnitTel4 != null and contactUnitTel4 != ''">
                contactUnitTel4 = #{contactUnitTel4},
            </if>
            <if test="contactMobile4 != null and contactMobile4 != ''">
                contactMobile4 = #{contactMobile4},
            </if>
            <if test="contactUnit4 != null and contactUnit4 != ''">
                contactUnit4 = #{contactUnit4},
            </if>
            <if test="contactAddress4 != null and contactAddress4 != ''">
                contactAddress4 = #{contactAddress4},
            </if>
            <if test="contactName5 != null and contactName5 != ''">
                contactName5 = #{contactName5},
            </if>
            <if test="contactIdentNo5 != null and contactIdentNo5 != ''">
                contactIdentNo5 = #{contactIdentNo5},
            </if>
            <if test="contactIdentType5 != null and contactIdentType5 != ''">
                contactIdentType5 = #{contactIdentType5},
            </if>
            <if test="contactRelation5 != null and contactRelation5 != ''">
                contactRelation5 = #{contactRelation5},
            </if>
            <if test="contactHomeTel5 != null and contactHomeTel5 != ''">
                contactHomeTel5 = #{contactHomeTel5},
            </if>
            <if test="contactUnitTel5 != null and contactUnitTel5 != ''">
                contactUnitTel5 = #{contactUnitTel5},
            </if>
            <if test="contactMobile5 != null and contactMobile5 != ''">
                contactMobile5 = #{contactMobile5},
            </if>
            <if test="contactUnit5 != null and contactUnit5 != ''">
                contactUnit5 = #{contactUnit5},
            </if>
            <if test="contactAddress5 != null and contactAddress5 != ''">
                contactAddress5 = #{contactAddress5},
            </if>
            <if test="contactName6 != null and contactName6 != ''">
                contactName6 = #{contactName6},
            </if>
            <if test="contactIdentNo6 != null and contactIdentNo6 != ''">
                contactIdentNo6 = #{contactIdentNo6},
            </if>
            <if test="contactIdentType6 != null and contactIdentType6 != ''">
                contactIdentType6 = #{contactIdentType6},
            </if>
            <if test="contactRelation6 != null and contactRelation6 != ''">
                contactRelation6 = #{contactRelation6},
            </if>
            <if test="contactHomeTel6 != null and contactHomeTel6 != ''">
                contactHomeTel6 = #{contactHomeTel6},
            </if>
            <if test="contactUnitTel6 != null and contactUnitTel6 != ''">
                contactUnitTel6 = #{contactUnitTel6},
            </if>
            <if test="contactMobile6 != null and contactMobile6 != ''">
                contactMobile6 = #{contactMobile6},
            </if>
            <if test="contactUnit6 != null and contactUnit6 != ''">
                contactUnit6 = #{contactUnit6},
            </if>
            <if test="contactAddress6 != null and contactAddress6 != ''">
                contactAddress6 = #{contactAddress6},
            </if>

            <if test="contactName7 != null and contactName7 != ''">
                contactName7 = #{contactName7},
            </if>
            <if test="contactIdentNo7 != null and contactIdentNo7 != ''">
                contactIdentNo7 = #{contactIdentNo7},
            </if>
            <if test="contactIdentType7 != null and contactIdentType7 != ''">
                contactIdentType7 = #{contactIdentType7},
            </if>
            <if test="contactRelation7 != null and contactRelation7 != ''">
                contactRelation7 = #{contactRelation7},
            </if>
            <if test="contactHomeTel7 != null and contactHomeTel7 != ''">
                contactHomeTel7 = #{contactHomeTel7},
            </if>
            <if test="contactUnitTel7 != null and contactUnitTel7 != ''">
                contactUnitTel7 = #{contactUnitTel7},
            </if>
            <if test="contactMobile7 != null and contactMobile7 != ''">
                contactMobile7 = #{contactMobile7},
            </if>
            <if test="contactUnit7 != null and contactUnit7 != ''">
                contactUnit7 = #{contactUnit7},
            </if>
            <if test="contactAddress7 != null and contactAddress7 != ''">
                contactAddress7 = #{contactAddress7},
            </if>

            <if test="contactName8 != null and contactName8 != ''">
                contactName8 = #{contactName8},
            </if>
            <if test="contactIdentNo8 != null and contactIdentNo8 != ''">
                contactIdentNo8 = #{contactIdentNo8},
            </if>
            <if test="contactIdentType8 != null and contactIdentType8 != ''">
                contactIdentType8 = #{contactIdentType8},
            </if>
            <if test="contactRelation8 != null and contactRelation8 != ''">
                contactRelation8 = #{contactRelation8},
            </if>
            <if test="contactHomeTel8 != null and contactHomeTel8 != ''">
                contactHomeTel8 = #{contactHomeTel8},
            </if>
            <if test="contactUnitTel8 != null and contactUnitTel8 != ''">
                contactUnitTel8 = #{contactUnitTel8},
            </if>
            <if test="contactMobile8 != null and contactMobile8 != ''">
                contactMobile8 = #{contactMobile8},
            </if>
            <if test="contactUnit8 != null and contactUnit8 != ''">
                contactUnit8 = #{contactUnit8},
            </if>
            <if test="contactAddress8 != null and contactAddress8 != ''">
                contactAddress8 = #{contactAddress8},
            </if>

            <if test="remark1 != null and remark1 != ''">
                remark1 = #{remark1},
            </if>
            <if test="remark2 != null and remark2 != ''">
                remark2 = #{remark2},
            </if>
            <if test="remark3 != null and remark3 != ''">
                remark3 = #{remark3},
            </if>
            <if test="remark4 != null and remark4 != ''">
                remark4 = #{remark4},
            </if>
            <if test="remark5 != null and remark5 != ''">
                remark5 = #{remark5},
            </if>
            <if test="remark6 != null and remark6 != ''">
                remark6 = #{remark6},
            </if>
            update_time = GETDATE()
        </trim>
    </set>
    where seq_no = #{seqNo}
</update>

    <update id="updateBatchBySeqNo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        <foreach collection ="records" item="record" separator=";" >

        update data_case
        <set >
            <trim suffixOverrides=",">
                <if test="record.caseDate != null and record.caseDate != ''">
                    case_date = #{record.caseDate},
                </if>
                <if test="record.money != null and record.money != ''">
                    money = #{record.money},
                </if>
                <if test="record.businessType != null and record.businessType != ''">
                    business_type = #{record.businessType},
                </if>
                <if test="record.caseDeadline != null and record.caseDeadline != ''">
                    case_deadline = #{record.caseDeadline},
                </if>
                <if test="record.collectHand != null and record.collectHand != ''">
                    collect_hand = #{record.collectHand},
                </if>
                <if test="record.rmb != null and record.rmb != ''">
                    rmb = #{record.rmb},
                </if>
                <if test="record.hkd != null and record.hkd != ''">
                    hkd = #{record.hkd},
                </if>
                <if test="record.foreignCurrency != null and record.foreignCurrency != ''">
                    foreign_currency = #{record.foreignCurrency},
                </if>
                <if test="record.gender != null and record.gender != ''">
                    gender = #{record.gender},
                </if>
                <if test="record.name != null and record.name != ''">
                    name = #{record.name},
                </if>
                <if test="record.cardNo != null and record.cardNo != ''">
                    card_no = #{record.cardNo},
                </if>
                <if test="record.identNo != null and record.identNo != ''">
                    ident_no = #{record.identNo},
                </if>
                <if test="record.identType != null and record.identType != ''">
                    ident_type = #{record.identType},
                </if>

                <if test="record.collectionUser != null and record.collectionUser.id != null">
                    odv = #{record.collectionUser.id},
                </if>
                <if test="record.collectionArea != null and record.collectionArea.id != null">
                    collection_area = #{record.collectionArea.id},
                </if>
                <if test="record.collectInfo != null and record.collectInfo != ''">
                    collect_result = #{record.collectInfo},
                </if>
                <if test="record.mVal != null and record.mVal != ''">
                    m_val = #{record.mVal},
                </if>
                <if test="record.commissionRate != null and record.commissionRate != ''">
                    commission_rate = #{record.commissionRate},
                </if>
                <if test="record.commissionMoney != null and record.commissionMoney != ''">
                    commission_money = #{record.commissionMoney},
                </if>
                <if test="record.homeTelNumber != null and record.homeTelNumber != ''">
                    home_tel_number = #{record.homeTelNumber},
                </if>
                <if test="record.unitTelNumber != null and record.unitTelNumber != ''">
                    unit_tel_number = #{record.unitTelNumber},
                </if>
                <if test="record.tel != null and record.tel != null">
                    tel = #{record.tel},
                </if>
                <if test="record.unitTelNumber != null and record.unitTelNumber != ''">
                    unit_name = #{record.unitName},
                </if>
                <if test="record.caseUserPosition != null and record.caseUserPosition != ''">
                    case_user_position = #{record.caseUserPosition},
                </if>
                <if test="record.caseUserDepart != null and record.caseUserDepart != ''">
                    case_user_depart = #{record.caseUserDepart},
                </if>
                <if test="record.unitAddress != null and record.unitAddress != ''">
                    unit_address = #{record.unitAddress},
                </if>
                <if test="record.unitZipCode != null and record.unitZipCode != ''">
                    unit_zip_code = #{record.unitZipCode},
                </if>
                <if test="record.homeAddress != null and record.homeAddress != ''">
                    home_address = #{record.homeAddress},
                </if>
                <if test="record.homeZipCode != null and record.homeZipCode != ''">
                    home_zip_code = #{record.homeZipCode},
                </if>
                <if test="record.statementAddress != null and record.statementAddress != ''">
                    statement_address = #{record.statementAddress},
                </if>
                <if test="record.statementZipCode != null and record.statementZipCode != ''">
                    statement_zip_code = #{record.statementZipCode},
                </if>
                <if test="record.censusRegisterAddress != null and record.censusRegisterAddress != ''">
                    census_register_address = #{record.censusRegisterAddress},
                </if>
                <if test="record.censusRegisterZipCode != null and record.censusRegisterZipCode != ''">
                    census_register_zip_code = #{record.censusRegisterZipCode},
                </if>
                <if test="record.qq != null and record.qq != ''">
                    qq = #{record.qq},
                </if>
                <if test="record.email != null and record.email != ''">
                    email = #{record.email},
                </if>
                <if test="record.birthday != null and record.birthday != ''">
                    birthday = #{record.birthday},
                </if>
                <if test="record.age != null and record.age != ''">
                    age = #{record.age},
                </if>
                <if test="record.province != null and record.province.name != null">
                    province = #{record.province.name},
                </if>
                <if test="record.city != null and record.city.name != null">
                    city = #{record.city.name},
                </if>
                <if test="record.county != null and record.county.name != null">
                    county = #{record.county.name},
                </if>
                <if test="record.expectTime != null and record.expectTime != ''">
                    expect_time = #{record.expectTime},
                </if>
                <if test="record.goods != null and record.goods != ''">
                    goods = #{record.goods},
                </if>
                <if test="record.commercialTenant != null and record.commercialTenant != ''">
                    commercial_tenant = #{record.commercialTenant},
                </if>
                <if test="record.archiveNo != null and record.archiveNo != ''">
                    archive_no = #{record.archiveNo},
                </if>
                <if test="record.applyOrderNo != null and record.applyOrderNo != ''">
                    apply_order_no = #{record.applyOrderNo},
                </if>
                <if test="record.socialSecurityComputerNo != null and record.socialSecurityComputerNo != ''">
                    social_security_computer_no = #{record.socialSecurityComputerNo},
                </if>
                <if test="record.socialSecurityCardNo != null and record.socialSecurityCardNo != ''">
                    social_security_card_no = #{record.socialSecurityCardNo},
                </if>
                <if test="record.bank != null and record.bank != ''">
                    bank = #{record.bank},
                </if>
                <if test="record.accountNo != null and record.accountNo != ''">
                    account_no = #{record.accountNo},
                </if>
                <if test="record.accountName != null and record.accountName != ''">
                    account_name = #{record.accountName},
                </if>
                <if test="record.cardType != null and record.cardType != ''">
                    card_type = #{record.cardType},
                </if>
                <if test="record.principle != null and record.principle != ''">
                    principle = #{record.principle},
                </if>
                <if test="record.loanRate != null and record.loanRate != ''">
                    loan_rate = #{record.loanRate},
                </if>
                <if test="record.residualPrinciple != null and record.residualPrinciple != ''">
                    residual_principle = #{record.residualPrinciple},
                </if>
                <if test="record.monthlyRepayments != null and record.monthlyRepayments != ''">
                    monthly_repayments = #{record.monthlyRepayments},
                </if>
                <if test="record.minimumPayment != null and record.minimumPayment != ''">
                    minimum_payment = #{record.minimumPayment},
                </if>
                <if test="record.creditLine != null and record.creditLine != ''">
                    credit_line = #{record.creditLine},
                </if>
                <if test="record.fixedQuota != null and record.fixedQuota != ''">
                    fixed_quota = #{record.fixedQuota},
                </if>
                <if test="record.defaultLevel != null and record.defaultLevel != ''">
                    default_level = #{record.defaultLevel},
                </if>
                <if test="record.lastRepayMoney != null and record.lastRepayMoney != ''">
                    last_repay_money = #{record.lastRepayMoney},
                </if>
                <if test="record.lastRepayDate != null">
                    last_repay_date = #{record.lastRepayDate},
                </if>
                <if test="record.lastConsumeDate != null">
                    last_consume_date = #{record.lastConsumeDate},
                </if>
                <if test="record.lastWithdrawDate != null">
                    last_withdraw_date = #{record.lastWithdrawDate},
                </if>
                <if test="record.stopCardDate != null">
                    stop_card_date = #{record.stopCardDate},
                </if>
                <if test="record.activeCardDate != null ">
                    active_card_date = #{record.activeCardDate},
                </if>
                <if test="record.billDate != null and record.billDate != ''">
                    bill_date = #{record.billDate},
                </if>
                <if test="record.billCycle != null and record.billCycle != ''">
                    bill_cycle = #{record.billCycle},
                </if>
                <if test="record.outstandingAmount != null and record.outstandingAmount != ''">
                    outstanding_amount = #{record.outstandingAmount},
                </if>
                <if test="record.mainDeputyCard != null and record.mainDeputyCard != ''">
                    main_deputy_card = #{record.mainDeputyCard},
                </if>
                <if test="record.deputyCardUserName != null and record.deputyCardUserName != ''">
                    deputy_card_user_name = #{record.deputyCardUserName},
                </if>
                <if test="record.loanDate != null ">
                    loan_date = #{record.loanDate},
                </if>
                <if test="record.loanDeadline != null">
                    loan_deadline = #{record.loanDeadline},
                </if>
                <if test="record.overdueDate != null ">
                    overdue_date = #{record.overdueDate},
                </if>
                <if test="record.overduePeriods != null and record.overduePeriods != ''">
                    overdue_periods = #{record.overduePeriods},
                </if>
                <if test="record.overdueDays != null">
                    overdue_days = #{record.overdueDays},
                </if>
                <if test="record.overdueTimes != null and record.overdueTimes != ''">
                    overdue_times = #{record.overdueTimes},
                </if>
                <if test="record.entrustPeriods != null and record.entrustPeriods != ''">
                    entrust_periods = #{record.entrustPeriods},
                </if>
                <if test="record.repayDeadline != null">
                    repay_deadline = #{record.repayDeadline},
                </if>
                <if test="record.repaidPeriods != null and record.repaidPeriods != ''">
                    repaid_periods = #{record.repaidPeriods},
                </if>
                <if test="record.loanType != null and record.loanType != ''">
                    loan_type = #{record.loanType},
                </if>
                <if test="record.collectionType != null and record.collectionType != ''">
                    collection_type = #{record.collectionType},
                </if>
                <if test="record.overdueMoney != null and record.overdueMoney != ''">
                    overdue_money = #{record.overdueMoney},
                </if>
                <if test="record.overduePrinciple != null and record.overduePrinciple != ''">
                    overdue_principle = #{record.overduePrinciple},
                </if>
                <if test="record.overdueInterest != null and record.overdueInterest != ''">
                    overdue_interest = #{record.overdueInterest},
                </if>
                <if test="record.overdueManagementCost != null and record.overdueManagementCost != ''">
                    overdue_management_cost = #{record.overdueManagementCost},
                </if>
                <if test="record.overdueDefaultInterest != null and record.overdueDefaultInterest != ''">
                    overdue_default_interest = #{record.overdueDefaultInterest},
                </if>
                <if test="record.penalty != null and record.penalty != ''">
                    penalty = #{record.penalty},
                </if>
                <if test="record.lateFee != null and record.lateFee != ''">
                    late_fee = #{record.lateFee},
                </if>
                <if test="record.overrunFee != null and record.overrunFee != ''">
                    overrun_fee = #{record.overrunFee},
                </if>
                <if test="record.bail != null and record.bail != ''">
                    bail = #{record.bail},
                </if>
                <if test="record.currencyType != null and record.currencyType != ''">
                    currency_type = #{record.currencyType},
                </if>
                <if test="record.lastCollectionRecord != null and record.lastCollectionRecord != ''">
                    last_collection_record = #{record.lastCollectionRecord},
                </if>
                <if test="record.overdueBillTime != null and record.overdueBillTime != ''">
                    overdue_bill_time = #{record.overdueBillTime},
                </if>
                <if test="record.contractNo != null and record.contractNo != ''">
                    contract_no = #{record.contractNo},
                </if>
                <if test="record.overDays != null and record.overDays != ''">
                    over_days = #{record.overDays},
                </if>
                <if test="record.dealer != null and record.dealer != ''">
                    dealer = #{record.dealer},
                </if>
                <if test="record.applyDate != null">
                    apply_date = #{record.applyDate},
                </if>
                <if test="record.repayDate != null and record.repayDate != ''">
                    repay_date = #{record.repayDate},
                </if>
                <if test="record.policyExpiryDate != null">
                    policy_expiry_date = #{record.policyExpiryDate},
                </if>
                <if test="record.cardPrice != null and record.cardPrice != ''">
                    card_price = #{record.cardPrice},
                </if>
                <if test="record.cardModel != null and record.cardModel != ''">
                    card_model = #{record.cardModel},
                </if>
                <if test="record.license != null and record.license != ''">
                    license = #{record.license},
                </if>
                <if test="record.brand != null and record.brand != ''">
                    brand = #{record.brand},
                </if>
                <if test="record.vin != null and record.vin != ''">
                    vin = #{record.vin},
                </if>
                <if test="record.engineNo != null and record.engineNo != ''">
                    engine_no = #{record.engineNo},
                </if>
                <if test="record.contactName1 != null and record.contactName1 != ''">
                    contactName1 = #{record.contactName1},
                </if>
                <if test="record.contactIdentNo1 != null and record.contactIdentNo1 != ''">
                    contactIdentNo1 = #{record.contactIdentNo1},
                </if>
                <if test="record.contactIdentType1 != null and record.contactIdentType1 != ''">
                    contactIdentType1 = #{record.contactIdentType1},
                </if>
                <if test="record.contactRelation1 != null and record.contactRelation1 != ''">
                    contactRelation1 = #{record.contactRelation1},
                </if>
                <if test="record.contactHomeTel1 != null and record.contactHomeTel1 != ''">
                    contactHomeTel1 = #{record.contactHomeTel1},
                </if>
                <if test="record.contactUnitTel1 != null and record.contactUnitTel1 != ''">
                    contactUnitTel1 = #{record.contactUnitTel1},
                </if>
                <if test="record.contactMobile1 != null and record.contactMobile1 != ''">
                    contactMobile1 = #{record.contactMobile1},
                </if>
                <if test="record.contactUnit1 != null and record.contactUnit1 != ''">
                    contactUnit1 = #{record.contactUnit1},
                </if>
                <if test="record.contactAddress1 != null and record.contactAddress1 != ''">
                    contactAddress1 = #{record.contactAddress1},
                </if>
                <if test="record.contactName2 != null and record.contactName2 != ''">
                    contactName2 = #{record.contactName2},
                </if>
                <if test="record.contactIdentNo2 != null and record.contactIdentNo2 != ''">
                    contactIdentNo2 = #{record.contactIdentNo2},
                </if>
                <if test="record.contactIdentType2 != null and record.contactIdentType2 != ''">
                    contactIdentType1 = #{record.contactIdentType1},
                </if>
                <if test="record.contactRelation2 != null and record.contactRelation2 != ''">
                    contactRelation2 = #{record.contactRelation2},
                </if>
                <if test="record.contactHomeTel2 != null and record.contactHomeTel2 != ''">
                    contactHomeTel2 = #{record.contactHomeTel2},
                </if>
                <if test="record.contactUnitTel2 != null and record.contactUnitTel2 != ''">
                    contactUnitTel2 = #{record.contactUnitTel2},
                </if>
                <if test="record.contactMobile2 != null and record.contactMobile2 != ''">
                    contactMobile2 = #{record.contactMobile2},
                </if>
                <if test="record.contactUnit2 != null and record.contactUnit2 != ''">
                    contactUnit2 = #{record.contactUnit2},
                </if>
                <if test="record.contactAddress2 != null and record.contactAddress2 != ''">
                    contactAddress2 = #{record.contactAddress2},
                </if>
                <if test="record.contactName3 != null and record.contactName3 != ''">
                    contactName3 = #{record.contactName3},
                </if>
                <if test="record.contactIdentNo3 != null and record.contactIdentNo3 != ''">
                    contactIdentNo3 = #{record.contactIdentNo3},
                </if>
                <if test="record.contactIdentType3 != null and record.contactIdentType3 != ''">
                    contactIdentType3 = #{record.contactIdentType3},
                </if>
                <if test="record.contactRelation3 != null and record.contactRelation3 != ''">
                    contactRelation3 = #{record.contactRelation3},
                </if>
                <if test="record.contactHomeTel3 != null and record.contactHomeTel3 != ''">
                    contactHomeTel3 = #{record.contactHomeTel3},
                </if>
                <if test="record.contactUnitTel3 != null and record.contactUnitTel3 != ''">
                    contactUnitTel3 = #{record.contactUnitTel3},
                </if>
                <if test="record.contactMobile3 != null and record.contactMobile3 != ''">
                    contactMobile3 = #{record.contactMobile3},
                </if>
                <if test="record.contactUnit3 != null and record.contactUnit3 != ''">
                    contactUnit3 = #{record.contactUnit3},
                </if>
                <if test="record.contactAddress3 != null and record.contactAddress3 != ''">
                    contactAddress3 = #{record.contactAddress3},
                </if>
                <if test="record.contactName4 != null and record.contactName4 != ''">
                    contactName4 = #{record.contactName4},
                </if>
                <if test="record.contactIdentNo4 != null and record.contactIdentNo4 != ''">
                    contactIdentNo4 = #{record.contactIdentNo4},
                </if>
                <if test="record.contactIdentType4 != null and record.contactIdentType4 != ''">
                    contactIdentType4 = #{record.contactIdentType4},
                </if>
                <if test="record.contactRelation4 != null and record.contactRelation4 != ''">
                    contactRelation4 = #{record.contactRelation4},
                </if>
                <if test="record.contactHomeTel4 != null and record.contactHomeTel4 != ''">
                    contactHomeTel4 = #{record.contactHomeTel4},
                </if>
                <if test="record.contactUnitTel4 != null and record.contactUnitTel4 != ''">
                    contactUnitTel4 = #{record.contactUnitTel4},
                </if>
                <if test="record.contactMobile4 != null and record.contactMobile4 != ''">
                    contactMobile4 = #{record.contactMobile4},
                </if>
                <if test="record.contactUnit4 != null and record.contactUnit4 != ''">
                    contactUnit4 = #{record.contactUnit4},
                </if>
                <if test="record.contactAddress4 != null and record.contactAddress4 != ''">
                    contactAddress4 = #{record.contactAddress4},
                </if>
                <if test="record.contactName5 != null and record.contactName5 != ''">
                    contactName5 = #{record.contactName5},
                </if>
                <if test="record.contactIdentNo5 != null and record.contactIdentNo5 != ''">
                    contactIdentNo5 = #{record.contactIdentNo5},
                </if>
                <if test="record.contactIdentType5 != null and record.contactIdentType5 != ''">
                    contactIdentType5 = #{record.contactIdentType5},
                </if>
                <if test="record.contactRelation5 != null and record.contactRelation5 != ''">
                    contactRelation5 = #{record.contactRelation5},
                </if>
                <if test="record.contactHomeTel5 != null and record.contactHomeTel5 != ''">
                    contactHomeTel5 = #{record.contactHomeTel5},
                </if>
                <if test="record.contactUnitTel5 != null and record.contactUnitTel5 != ''">
                    contactUnitTel5 = #{record.contactUnitTel5},
                </if>
                <if test="record.contactMobile5 != null and record.contactMobile5 != ''">
                    contactMobile5 = #{record.contactMobile5},
                </if>
                <if test="record.contactUnit5 != null and record.contactUnit5 != ''">
                    contactUnit5 = #{record.contactUnit5},
                </if>
                <if test="record.contactAddress5 != null and record.contactAddress5 != ''">
                    contactAddress5 = #{record.contactAddress5},
                </if>
                <if test="record.contactName6 != null and record.contactName6 != ''">
                    contactName6 = #{record.contactName6},
                </if>
                <if test="record.contactIdentNo6 != null and record.contactIdentNo6 != ''">
                    contactIdentNo6 = #{record.contactIdentNo6},
                </if>
                <if test="record.contactIdentType6 != null and record.contactIdentType6 != ''">
                    contactIdentType6 = #{record.contactIdentType6},
                </if>
                <if test="record.contactRelation6 != null and record.contactRelation6 != ''">
                    contactRelation6 = #{record.contactRelation6},
                </if>
                <if test="record.contactHomeTel6 != null and record.contactHomeTel6 != ''">
                    contactHomeTel6 = #{record.contactHomeTel6},
                </if>
                <if test="record.contactUnitTel6 != null and record.contactUnitTel6 != ''">
                    contactUnitTel6 = #{record.contactUnitTel6},
                </if>
                <if test="record.contactMobile6 != null and record.contactMobile6 != ''">
                    contactMobile6 = #{record.contactMobile6},
                </if>
                <if test="record.contactUnit6 != null and record.contactUnit6 != ''">
                    contactUnit6 = #{record.contactUnit6},
                </if>
                <if test="record.contactAddress6 != null and record.contactAddress6 != ''">
                    contactAddress6 = #{record.contactAddress6},
                </if>
                <if test="record.remark1 != null and record.remark1 != ''">
                    remark1 = #{record.remark1},
                </if>
                <if test="record.remark2 != null and record.remark2 != ''">
                    remark2 = #{record.remark2},
                </if>
                <if test="record.remark3 != null and record.remark3 != ''">
                    remark3 = #{record.remark3},
                </if>
                <if test="record.remark4 != null and record.remark4 != ''">
                    remark4 = #{record.remark4},
                </if>
                <if test="record.remark5 != null and record.remark5 != ''">
                    remark5 = #{record.remark5},
                </if>
                <if test="record.remark6 != null and record.remark6 != ''">
                    remark6 = #{record.remark6},
                </if>
            </trim>
        </set>
        where seq_no = #{record.seqNo}
        </foreach>
    </update>

    <insert id="saveCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT @@IDENTITY AS 'Identity'
        </selectKey>
        insert into data_case
        (
        seq_no,
        case_date,
        money,
        dept,
        client,
        case_deadline,
        collect_hand,
        rmb,
        hkd,
        foreign_currency,
        gender,
        business_type,
        name,
        card_no,
        ident_no,
        ident_type,
        <if test="collectionUser != null and collectionUser.id != null">
            odv,
        </if>
        <if test="collectionArea != null and collectionArea.id != null">
            collection_area,
        </if>
        collect_result,
        m_val,
        commission_rate,
        commission_money,
        home_tel_number,
        unit_tel_number,
        tel,
        unit_name,
        case_user_position,
        case_user_depart,
        unit_address,
        unit_zip_code,
        home_address,
        home_zip_code,
        statement_address,
        statement_zip_code,
        census_register_address,
        census_register_zip_code,
        qq,
        email,
        birthday,
        age,
        <if test="province != null and province.name != null">
            province,
        </if>
        <if test="city != null and city.name != null">
            city,
        </if>
        <if test="county != null and county.name != null">
            county,
        </if>
        expect_time,
        goods,
        commercial_tenant,
        archive_no,
        apply_order_no,
        social_security_computer_no,
        social_security_card_no,
        bank,
        account,
        account_name,
        card_type,
        principle,
        loan_rate,
        residual_principle,
        monthly_repayments,
        minimum_payment,
        credit_line,
        fixed_quota,
        default_level,
        last_repay_money,
        last_repay_date,
        last_consume_date,
        last_withdraw_date,
        stop_card_date,
        active_card_date,
        bill_date,
        bill_cycle,
        outstanding_amount,
        main_deputy_card,
        deputy_card_user_name,
        loan_date,
        loan_deadline,
        overdue_date,
        overdue_periods,
        overdue_days,
        overdue_times,
        entrust_periods,
        repay_deadline,
        repaid_periods,
        loan_type,
        collection_type,
        overdue_money,
        overdue_principle,
        overdue_interest,
        overdue_management_cost,
        overdue_default_interest,
        penalty,
        late_fee,
        overrun_fee,
        bail,
        currency_type,
        last_collection_record,
        account_age,
        contract_no,
        over_days,
        dealer,
        apply_date,
        repay_date,
        policy_expiry_date,
        card_price,
        card_model,
        license,
        brand,
        vin,
        engine_no,
        batch_no,
        distribute_history,
        collect_times,
        distribute_status,
        distribute_time,
        remark1,
        remark2,
        remark3,
        remark4,
        remark5,
        remark6,
        contactName1,
        contactIdentNo1,
        contactIdentType1,
        contactRelation1,
        contactHomeTel1,
        contactUnitTel1,
        contactMobile1,
        contactUnit1,
        contactAddress1,
        contactName2,
        contactIdentNo2,
        contactIdentType2,
        contactRelation2,
        contactHomeTel2,
        contactUnitTel2,
        contactMobile2,
        contactUnit2,
        contactAddress2,
        contactName3,
        contactIdentNo3,
        contactIdentType3,
        contactRelation3,
        contactHomeTel3,
        contactUnitTel3,
        contactMobile3,
        contactUnit3,
        contactAddress3,
        contactName4,
        contactIdentNo4,
        contactIdentType4,
        contactRelation4,
        contactHomeTel4,
        contactUnitTel4,
        contactMobile4,
        contactUnit4,
        contactAddress4,
        contactName5,
        contactIdentNo5,
        contactIdentType5,
        contactRelation5,
        contactHomeTel5,
        contactUnitTel5,
        contactMobile5,
        contactUnit5,
        contactAddress5,
        contactName6,
        contactIdentNo6,
        contactIdentType6,
        contactRelation6,
        contactHomeTel6,
        contactUnitTel6,
        contactMobile6,
        contactUnit6,
        contactAddress6,
        contactName7,
        contactIdentNo7,
        contactIdentType7,
        contactRelation7,
        contactHomeTel7,
        contactUnitTel7,
        contactMobile7,
        contactUnit7,
        contactAddress7,
        contactName8,
        contactIdentNo8,
        contactIdentType8,
        contactRelation8,
        contactHomeTel8,
        contactUnitTel8,
        contactMobile8,
        contactUnit8,
        contactAddress8,
        delete_flag,
        status,
        create_time,
        real_return_time,
        collect_status,
        collect_date
        )
        values
        (
        #{seqNo},
        #{caseDateD},
        #{money},
        #{dept},
        #{client},
        #{caseDeadline},
        #{collectHand},
        #{rmb},
        #{hkd},
        #{foreignCurrency},
        #{gender},
        #{businessType},
        #{name},
        #{cardNo},
        #{identNo},
        #{identType},
        <if test="collectionUser != null and collectionUser.id != null">
            #{collectionUser.id},
        </if>
        <if test="collectionArea != null and collectionArea.id != null">
            #{collectionArea.id},
        </if>
        #{collectInfo},
        #{mVal},
        #{commissionRate},
        #{commissionMoney},
        #{homeTelNumber},
        #{unitTelNumber},
        #{tel},
        #{unitName},
        #{caseUserPosition},
        #{caseUserDepart},
        #{unitAddress},
        #{unitZipCode},
        #{homeAddress},
        #{homeZipCode},
        #{statementAddress},
        #{statementZipCode},
        #{censusRegisterAddress},
        #{censusRegisterZipCode},
        #{qq},
        #{email},
        #{birthday},
        #{age},
        <if test="province != null and province.name != null">
            #{province.name},
        </if>
        <if test="city != null and city.name != null">
            #{city.name},
        </if>
        <if test="county != null and county.name != null">
            #{county.name},
        </if>
        #{expectTime},
        #{goods},
        #{commercialTenant},
        #{archiveNo},
        #{applyOrderNo},
        #{socialSecurityComputerNo},
        #{socialSecurityCardNo},
        #{bank},
        #{account},
        #{accountName},
        #{cardType},
        #{principle},
        #{loanRate},
        #{residualPrinciple},
        #{monthlyRepayments},
        #{minimumPayment},
        #{creditLine},
        #{fixedQuota},
        #{defaultLevel},
        #{lastRepayMoney},
        #{lastRepayDate},
        #{lastConsumeDate},
        #{lastWithdrawDate},
        #{stopCardDate},
        #{activeCardDate},
        #{billDate},
        #{billCycle},
        #{outstandingAmount},
        #{mainDeputyCard},
        #{deputyCardUserName},
        #{loanDate},
        #{loanDeadline},
        #{overdueDate},
        #{overduePeriods},
        <if test="overdueDays != null and overdueDays != ''">
            #{overdueDays},
        </if>
        <if test="overdueDays == null or overdueDays == ''">
            0,
        </if>
        #{overdueTimes},
        #{entrustPeriods},
        #{repayDeadline},
        #{repaidPeriods},
        #{loanType},
        #{collectionType},
        #{overdueMoney},
        #{overduePrinciple},
        #{overdueInterest},
        #{overdueManagementCost},
        #{overdueDefaultInterest},
        #{penalty},
        #{lateFee},
        #{overrunFee},
        #{bail},
        #{currencyType},
        #{lastCollectionRecord},
        #{accountAge},
        #{contractNo},
        #{overDays},
        #{dealer},
        #{applyDate},
        #{repayDate},
        #{policyExpiryDate},
        #{cardPrice},
        #{cardModel},
        #{license},
        #{brand},
        #{vin},
        #{engineNo},
        #{batchNo},
        #{distributeHistory},
        0,
        1,
        #{distributeDate},
        #{remark1},
        #{remark2},
        #{remark3},
        #{remark4},
        #{remark5},
        #{remark6},
        #{contactName1},
        #{contactIdentNo1},
        #{contactIdentType1},
        #{contactRelation1},
        #{contactHomeTel1},
        #{contactUnitTel1},
        #{contactMobile1},
        #{contactUnit1},
        #{contactAddress1},
        #{contactName2},
        #{contactIdentNo2},
        #{contactIdentType2},
        #{contactRelation2},
        #{contactHomeTel2},
        #{contactUnitTel2},
        #{contactMobile2},
        #{contactUnit2},
        #{contactAddress2},
        #{contactName3},
        #{contactIdentNo3},
        #{contactIdentType3},
        #{contactRelation3},
        #{contactHomeTel3},
        #{contactUnitTel3},
        #{contactMobile3},
        #{contactUnit3},
        #{contactAddress3},
        #{contactName4},
        #{contactIdentNo4},
        #{contactIdentType4},
        #{contactRelation4},
        #{contactHomeTel4},
        #{contactUnitTel4},
        #{contactMobile4},
        #{contactUnit4},
        #{contactAddress4},
        #{contactName5},
        #{contactIdentNo5},
        #{contactIdentType5},
        #{contactRelation5},
        #{contactHomeTel5},
        #{contactUnitTel5},
        #{contactMobile5},
        #{contactUnit5},
        #{contactAddress5},
        #{contactName6},
        #{contactIdentNo6},
        #{contactIdentType6},
        #{contactRelation6},
        #{contactHomeTel6},
        #{contactUnitTel6},
        #{contactMobile6},
        #{contactUnit6},
        #{contactAddress6},
        #{contactName7},
        #{contactIdentNo7},
        #{contactIdentType7},
        #{contactRelation7},
        #{contactHomeTel7},
        #{contactUnitTel7},
        #{contactMobile7},
        #{contactUnit7},
        #{contactAddress7},
        #{contactName8},
        #{contactIdentNo8},
        #{contactIdentType8},
        #{contactRelation8},
        #{contactHomeTel8},
        #{contactUnitTel8},
        #{contactMobile8},
        #{contactUnit8},
        #{contactAddress8},
        0,
        1,
        GETDATE(),
        #{realReturnTime},
        832,
        GETDATE()
        )
    </insert>

    <insert id="saveBatchCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT @@IDENTITY AS 'Identity'
        </selectKey>
        insert into data_case
        (
        seq_no,
        case_date,
        money,
        dept,
        client,
        case_deadline,
        collect_hand,
        rmb,
        hkd,
        foreign_currency,
        gender,
        business_type,
        name,
        card_no,
        ident_no,
        ident_type,

            odv,


            collection_area,

        collect_result,
        m_val,
        commission_rate,
        commission_money,
        home_tel_number,
        unit_tel_number,
        tel,
        unit_name,
        case_user_position,
        case_user_depart,
        unit_address,
        unit_zip_code,
        home_address,
        home_zip_code,
        statement_address,
        statement_zip_code,
        census_register_address,
        census_register_zip_code,
        qq,
        email,
        birthday,
        age,

            province,

            city,

            county,

        expect_time,
        goods,
        commercial_tenant,
        archive_no,
        apply_order_no,
        social_security_computer_no,
        social_security_card_no,
        bank,
        account,
        account_name,
        card_type,
        principle,
        loan_rate,
        residual_principle,
        monthly_repayments,
        minimum_payment,
        credit_line,
        fixed_quota,
        default_level,
        last_repay_money,
        last_repay_date,
        last_consume_date,
        last_withdraw_date,
        stop_card_date,
        active_card_date,
        bill_date,
        bill_cycle,
        outstanding_amount,
        main_deputy_card,
        deputy_card_user_name,
        loan_date,
        loan_deadline,
        overdue_date,
        overdue_periods,
        overdue_days,
        overdue_times,
        entrust_periods,
        repay_deadline,
        repaid_periods,
        loan_type,
        collection_type,
        overdue_money,
        overdue_principle,
        overdue_interest,
        overdue_management_cost,
        overdue_default_interest,
        penalty,
        late_fee,
        overrun_fee,
        bail,
        currency_type,
        last_collection_record,
        account_age,
        contract_no,
        over_days,
        dealer,
        apply_date,
        repay_date,
        policy_expiry_date,
        card_price,
        card_model,
        license,
        brand,
        vin,
        engine_no,
        batch_no,
        distribute_history,
        collect_times,
        distribute_status,
        remark1,
        remark2,
        remark3,
        remark4,
        remark5,
        remark6,
        contactName1,
        contactIdentNo1,
        contactIdentType1,
        contactRelation1,
        contactHomeTel1,
        contactUnitTel1,
        contactMobile1,
        contactUnit1,
        contactAddress1,
        contactName2,
        contactIdentNo2,
        contactIdentType2,
        contactRelation2,
        contactHomeTel2,
        contactUnitTel2,
        contactMobile2,
        contactUnit2,
        contactAddress2,
        contactName3,
        contactIdentNo3,
        contactIdentType3,
        contactRelation3,
        contactHomeTel3,
        contactUnitTel3,
        contactMobile3,
        contactUnit3,
        contactAddress3,
        contactName4,
        contactIdentNo4,
        contactIdentType4,
        contactRelation4,
        contactHomeTel4,
        contactUnitTel4,
        contactMobile4,
        contactUnit4,
        contactAddress4,
        contactName5,
        contactIdentNo5,
        contactIdentType5,
        contactRelation5,
        contactHomeTel5,
        contactUnitTel5,
        contactMobile5,
        contactUnit5,
        contactAddress5,
        contactName6,
        contactIdentNo6,
        contactIdentType6,
        contactRelation6,
        contactHomeTel6,
        contactUnitTel6,
        contactMobile6,
        contactUnit6,
        contactAddress6,
        delete_flag,
        status,
        real_return_time,
        collect_date
        )
        values
        <foreach collection="list" item="record" separator=",">

        (
        #{record.seqNo},
        #{record.caseDate},
        #{record.money},
        #{record.dept},
        #{record.client},
        #{record.caseDeadline},
        #{record.collectHand},
        #{record.rmb},
        #{record.hkd},
        #{record.foreignCurrency},
        #{record.gender},
        #{record.businessType},
        #{record.name},
        #{record.cardNo},
        #{record.identNo},
        #{record.identType},

            #{record.collectionUser.id},


            #{record.collectionArea.id},

        #{record.collectInfo},
        #{record.mVal},
        #{record.commissionRate},
        #{record.commissionMoney},
        #{record.homeTelNumber},
        #{record.unitTelNumber},
        #{record.tel},
        #{record.unitName},
        #{record.caseUserPosition},
        #{record.caseUserDepart},
        #{record.unitAddress},
        #{record.unitZipCode},
        #{record.homeAddress},
        #{record.homeZipCode},
        #{record.statementAddress},
        #{record.statementZipCode},
        #{record.censusRegisterAddress},
        #{record.censusRegisterZipCode},
        #{record.qq},
        #{record.email},
        #{record.birthday},
        #{record.age},

            #{record.province.name},

            #{record.city.name},

            #{record.county.name},

        #{record.expectTime},
        #{record.goods},
        #{record.commercialTenant},
        #{record.archiveNo},
        #{record.applyOrderNo},
        #{record.socialSecurityComputerNo},
        #{record.socialSecurityCardNo},
        #{record.bank},
        #{record.account},
        #{record.accountName},
        #{record.cardType},
        #{record.principle},
        #{record.loanRate},
        #{record.residualPrinciple},
        #{record.monthlyRepayments},
        #{record.minimumPayment},
        #{record.creditLine},
        #{record.fixedQuota},
        #{record.defaultLevel},
        #{record.lastRepayMoney},
        #{record.lastRepayDate},
        #{record.lastConsumeDate},
        #{record.lastWithdrawDate},
        #{record.stopCardDate},
        #{record.activeCardDate},
        #{record.billDate},
        #{record.billCycle},
        #{record.outstandingAmount},
        #{record.mainDeputyCard},
        #{record.deputyCardUserName},
        #{record.loanDate},
        #{record.loanDeadline},
        #{record.overdueDate},
        #{record.overduePeriods},
        #{record.overdueDays},
        #{record.overdueTimes},
        #{record.entrustPeriods},
        #{record.repayDeadline},
        #{record.repaidPeriods},
        #{record.loanType},
        #{record.collectionType},
        #{record.overdueMoney},
        #{record.overduePrinciple},
        #{record.overdueInterest},
        #{record.overdueManagementCost},
        #{record.overdueDefaultInterest},
        #{record.penalty},
        #{record.lateFee},
        #{record.overrunFee},
        #{record.bail},
        #{record.currencyType},
        #{record.lastCollectionRecord},
        #{record.accountAge},
        #{record.contractNo},
        #{record.overDays},
        #{record.dealer},
        #{record.applyDate},
        #{record.repayDate},
        #{record.policyExpiryDate},
        #{record.cardPrice},
        #{record.cardModel},
        #{record.license},
        #{record.brand},
        #{record.vin},
        #{record.engineNo},
        #{record.batchNo},
        '',
        0,
        1,
        #{record.remark1},
        #{record.remark2},
        #{record.remark3},
        #{record.remark4},
        #{record.remark5},
        #{record.remark6},
        #{record.contactName1},
        #{record.contactIdentNo1},
        #{record.contactIdentType1},
        #{record.contactRelation1},
        #{record.contactHomeTel1},
        #{record.contactUnitTel1},
        #{record.contactMobile1},
        #{record.contactUnit1},
        #{record.contactAddress1},
        #{record.contactName2},
        #{record.contactIdentNo2},
        #{record.contactIdentType2},
        #{record.contactRelation2},
        #{record.contactHomeTel2},
        #{record.contactUnitTel2},
        #{record.contactMobile2},
        #{record.contactUnit2},
        #{record.contactAddress2},
        #{record.contactName3},
        #{record.contactIdentNo3},
        #{record.contactIdentType3},
        #{record.contactRelation3},
        #{record.contactHomeTel3},
        #{record.contactUnitTel3},
        #{record.contactMobile3},
        #{record.contactUnit3},
        #{record.contactAddress3},
        #{record.contactName4},
        #{record.contactIdentNo4},
        #{record.contactIdentType4},
        #{record.contactRelation4},
        #{record.contactHomeTel4},
        #{record.contactUnitTel4},
        #{record.contactMobile4},
        #{record.contactUnit4},
        #{record.contactAddress4},
        #{record.contactName5},
        #{record.contactIdentNo5},
        #{record.contactIdentType5},
        #{record.contactRelation5},
        #{record.contactHomeTel5},
        #{record.contactUnitTel5},
        #{record.contactMobile5},
        #{record.contactUnit5},
        #{record.contactAddress5},
        #{record.contactName6},
        #{record.contactIdentNo6},
        #{record.contactIdentType6},
        #{record.contactRelation6},
        #{record.contactHomeTel6},
        #{record.contactUnitTel6},
        #{record.contactMobile6},
        #{record.contactUnit6},
        #{record.contactAddress6},
            0,
            1,
            #{realReturnTime},
            GETDATE()
        )
        </foreach>
    </insert>

    <select id="selectCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select da.color,
        <foreach collection ="exportKeyList" item="reddemCode" index= "index" separator =",">
            ${reddemCode}
        </foreach >
        from data_case da
        where   da.id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <select id="selectDataCaseExportByBatch" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        <foreach collection ="exportKeyList" item="reddemCode" index= "index" separator =",">
            ${reddemCode}
        </foreach >
        from data_case da LEFT JOIN data_collection dc on da.id = dc.case_id
        where   da.batch_no = #{batchNo} and da.delete_flag=0
        order by da.id desc
    </select>

    <select id="listSend" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.seq_no as seqNo
        from data_case da
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and da.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overDays != null and overDays!=''">
                    and da.overdue_days = #{overDays}
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>
                <if test="batchNo != null and batchNo!=''">
                    and da.batch_no = #{batchNo}
                </if>
                <if test="dept != null and dept!=''">
                    and da.dept = #{dept}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatus != null and collectStatus!=''">
                    and da.collect_status = #{collectStatus}
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}   ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>= #{collectStartDate}  ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>

    <select id="totalCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.color,
        <foreach collection ="exportKeyList" item="reddemCode" index= "index" separator =",">
            ${reddemCode}
        </foreach >
        from data_case da
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>
                <if test="batchNo != null and batchNo!=''">
                    and da.batch_no = #{batchNo}
                </if>
                <if test="dept != null and dept!=''">
                    and da.dept = #{dept}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}   ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>= #{collectStartDate}  ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
        order by ${orderBy} ${sort}
    </select>

    <select id="totalSendCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  <include refid="colSql"/>
        from data_case da
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>
                <if test="batchNo != null and batchNo!=''">
                    and da.batch_no = #{batchNo}
                </if>
                <if test="dept != null and dept!=''">
                    and da.dept = #{dept}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}   ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>= #{collectStartDate}  ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>

    <update id="cleanTimes" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_times = 0
        where id in
            <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                '${item}'
            </foreach>

    </update>

    <update id="cleanCollect" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_result = ''
        where id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            '${item}'
        </foreach>

    </update>

    <select id="autoQuery1" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.id,da.odv,da.seq_no as seqNo,da.money,da.distribute_history as distributeHistory
        from data_case da where da.ident_no in (
        select t.ident_no
        from data_case t LEFT JOIN data_collection dc on t.id = dc.case_id
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="sendModule != null and sendModule!=''">
                    and (t.odv is  null or t.odv='')
                </if>
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and t.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and t.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and t.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and t.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and t.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and t.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and t.client in
                    <foreach item="item" index="index" collection="client" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and t.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and t.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="dept != null and dept!=''">
                    and t.dept = #{dept}
                </if>

                <if test="accountAge != null and accountAge!=''">
                    and t.account_age = #{accountAge}
                </if>
                <if test="collectArea != null and collectArea!=''">
                    and t.collect_area = #{collectArea}
                </if>
                <if test="overDays != null and overDays!=''">
                    and t.over_days = #{overDays}
                </if>
                <if test="area != null and area!=''">
                    and t.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and t.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and t.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and t.county = #{county.name}
                </if>
                <if test="license != null and license!=''">
                    and t.license = #{license}
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>

                <if test="collectHand != null and collectHand!=''">
                    and t.collect_hand = #{collectHand}
                </if>
                <if test="distributeStatus != null and distributeStatus!=''">
                    and t.distribute_status = #{distributeStatus}
                </if>
                <if test="vin != null and vin!=''">
                    and t.vin = #{vin}
                </if>
                <if test="status != null and status!=''">
                    and t.status = #{status}
                </if>
                <if test="bank != null and bank!=''">
                    and t.bank = #{bank}
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and dc.collectInfo = #{collectInfo}
                </if>
                <if test="collectStatus != null and collectStatus!=''">
                    and dc.collect_status = #{collectStatus}
                </if>
                <if test="caseType != null and caseType!=''">
                    and t.case_type = #{caseType}
                </if>
                <if test="color != null and color!=''">
                    and t.color = #{color}
                </if>

                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and t.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and t.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')>=  #{moneyStart}   ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')<=  #{moneyEnd}   ]]>
                </if>

                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')>= #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
        )
    </select>

    <select id="autoQuery2" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.id,da.odv,da.seq_no as seqNo,da.money,da.distribute_history as distributeHistory
        from data_case da
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="sendModule != null and sendModule!=''">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overDays != null and overDays!=''">
                    and da.overdue_days = #{overDays}
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>
                <if test="batchNo != null and batchNo!=''">
                    and da.batch_no = #{batchNo}
                </if>
                <if test="dept != null and dept!=''">
                    and da.dept = #{dept}
                </if>
                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="status != null and status!=''">
                    and da.status = #{status}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatus != null and collectStatus!=''">
                    and da.collect_status = #{collectStatus}
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>

                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}   ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>= #{collectStartDate}  ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
    </select>


    <select id="totalBatchBoundsCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  da.color,
        <foreach collection ="exportKeyList" item="reddemCode" index= "index" separator =",">
            ${reddemCode}
        </foreach >
         from data_case da where da.delete_flag=0 and  da.ident_no in (
        select t.ident_no
        from data_case t LEFT JOIN data_collection dc on t.id = dc.case_id
        <where>
            1 = 1
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and t.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and t.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and t.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and t.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and t.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and t.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and t.client in
                    <foreach item="item" index="index" collection="client" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and t.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and t.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="dept != null and dept!=''">
                    and t.dept = #{dept}
                </if>

                <if test="accountAge != null and accountAge!=''">
                    and t.account_age = #{accountAge}
                </if>
                <if test="collectArea != null and collectArea!=''">
                    and t.collect_area = #{collectArea}
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <if test="area != null and area!=''">
                    and t.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and t.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and t.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and t.county = #{county.name}
                </if>
                <if test="license != null and license!=''">
                    and t.license = #{license}
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>

                <if test="collectHand != null and collectHand!=''">
                    and t.collect_hand = #{collectHand}
                </if>
                <if test="distributeStatus != null and distributeStatus!=''">
                    and t.distribute_status = #{distributeStatus}
                </if>
                <if test="vin != null and vin!=''">
                    and t.vin = #{vin}
                </if>
                <if test="status != null and status!=''">
                    and t.status = #{status}
                </if>
                <if test="bank != null and bank!=''">
                    and t.bank = #{bank}
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and dc.collectInfo = #{collectInfo}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="caseType != null and caseType!=''">
                    and t.case_type = #{caseType}
                </if>
                <if test="color != null and color!=''">
                    and t.color = #{color}
                </if>

                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and t.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and t.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')>=  #{moneyStart}   ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')<=  #{moneyEnd}   ]]>
                </if>

                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')>= #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
        order by ${orderBy} ${sort}
        )
    </select>


    <select id="totalSendBatchBoundsCaseList" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select   <include refid="colSql"/>
        from data_case da where da.delete_flag=0 and  da.ident_no in (
        select t.ident_no
        from data_case t LEFT JOIN data_collection dc on t.id = dc.case_id
        <where>
            1 = 1
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and t.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and t.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and t.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and t.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and t.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and t.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and t.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and t.client in
                    <foreach item="item" index="index" collection="client" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and t.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and t.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="dept != null and dept!=''">
                    and t.dept = #{dept}
                </if>

                <if test="accountAge != null and accountAge!=''">
                    and t.account_age = #{accountAge}
                </if>
                <if test="collectArea != null and collectArea!=''">
                    and t.collect_area = #{collectArea}
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <if test="area != null and area!=''">
                    and t.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and t.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and t.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and t.county = #{county.name}
                </if>
                <if test="license != null and license!=''">
                    and t.license = #{license}
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>

                <if test="collectHand != null and collectHand!=''">
                    and t.collect_hand = #{collectHand}
                </if>
                <if test="distributeStatus != null and distributeStatus!=''">
                    and t.distribute_status = #{distributeStatus}
                </if>
                <if test="vin != null and vin!=''">
                    and t.vin = #{vin}
                </if>
                <if test="status != null and status!=''">
                    and t.status = #{status}
                </if>
                <if test="bank != null and bank!=''">
                    and t.bank = #{bank}
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>
                <if test="collectInfo != null and collectInfo!=''">
                    and dc.collectInfo = #{collectInfo}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="caseType != null and caseType!=''">
                    and t.case_type = #{caseType}
                </if>
                <if test="color != null and color!=''">
                    and t.color = #{color}
                </if>

                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and t.case_date>=  #{caseDateStart}   ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and t.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')>=  #{moneyStart}   ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.money, 'yyyy-MM-dd')<=  #{moneyEnd}   ]]>
                </if>

                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')>= #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(t.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
            </trim>
        </where>
        )
    </select>


    <select id="selectCaseTelListExport" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseTelExport" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseTelExport">
          SELECT
        <foreach collection ="exportKeyList" item="reddemCode" index= "index" separator =",">
            ${reddemCode}
        </foreach >
          from data_case_tel t LEFT  JOIN data_case d on t.case_id = d.id
          where d.id in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>


    <select id="detail" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseDetail">
          select
        <include refid="detailColSql"/>
          from data_case da where da.id = #{id}
    </select>

    <update id="updateRemark" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" >

          update data_case set remark = #{remark} where id = #{id}

    </update>

    <update id="updateCaseByBatch" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" >

        update data_case set status = #{status} where batch_no = #{batchNo}

    </update>

    <update id="updateBatch" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" >

        update data_case set batch_no = #{batchNo} where batch_no = #{oldBatchNo}

    </update>

    <select id="pageSeqNos" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select
        <include refid="topcolSql"/>
        from data_case da
        where da.delete_flag = 0
        <if test="seqNo != null and seqNo != ''">
            and da.seq_no like '%${seqNo}%'
        </if>
    </select>

    <select id="listSynergy" parameterType="java.util.List" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          SELECT
            t.id,t.synergy,t.synergy_type as synergyType,t.synergy_context as synergyContext,t.synergy_date as synergyDate,t.odv,t.synergy_checker as synerCkecker,t.synergy_context as synerCheckContext,t.syner_check_time as synergyCheckTime
          from data_case t
          where t.synergy in
        <foreach item="item" index="index" collection="array" open="(" separator="," close=")">
            #{item}
        </foreach>

    </select>

    <select id="findById" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          SELECT id,batch_no as batchNo,money,odv,ident_no as identNo,seq_no as seqNo,archive_no as archiveNo,business_type as businessType,card_no as cardNo,dbo.fnFormatDate(case_date, 'yyyy-MM-dd') as caseDate,name,
          dbo.fnFormatDate(settle_date, 'yyyy-MM-dd') as settleDate,settle_flag as settleFlag,en_repay_amt as enRepayAmt,distribute_history as distributeHistory,status
          from data_case where id = #{id}
    </select>

    <select id="findThisMonthById" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  sum(r.repayMoney) as enRepayAmt
        from data_case t RIGHT JOIN (
        select repay_money as repayMoney,data_case
        from data_case_repay_record
        where data_case in (select id from data_case where business_type = (select business_type from data_case where id = #{id}))
        <if test="repayDateStart != null and repayDateStart != ''">
            <![CDATA[   and  convert(datetime,repay_date, 20) >= convert(datetime,#{repayDateStart}, 20) ]]>
        </if>
        <if test="repayDateEnd != null and repayDateEnd != ''">
            <![CDATA[   and convert(datetime,repay_date, 20) <= convert(datetime,#{repayDateEnd}, 20) ]]>
        </if>
        and collect_user = #{odv}
        ) r on t.id = r.data_case

    </select>

    <select id="findThisMonthTSById1" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  r.repayMoney as enRepayAmt,t.money,t.settle_flag as settleFlag,t.settle_date as settleDate
        from (
          select id,money,settle_flag ,settle_date  from  data_case
        <where>
            <if test="repayDateStart != null and repayDateStart != ''">
                <![CDATA[   and  settle_date >= convert(datetime,#{repayDateStart}, 20) ]]>
            </if>
            <if test="repayDateEnd != null and repayDateEnd != ''">
                <![CDATA[   and settle_date <= convert(datetime,#{repayDateEnd}, 20) ]]>
            </if>
        </where>
        ) t INNER JOIN (
        select sum(repay_money) as repayMoney,data_case
        from data_case_repay_record
        where data_case in (select id from data_case where business_type = #{businessType})
        and collect_user = #{odv}
        group by data_case
        ) r on t.id = r.data_case

    </select>

    <select id="findThisMonthTSById2" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  r.repayMoney as enRepayAmt,t.money,t.settle_flag as settleFlag,t.settle_date as settleDate
        from data_case t RIGHT JOIN (
        select sum(repay_money) as repayMoney,data_case
        from data_case_repay_record
        where data_case in (select id from data_case where business_type = #{businessType})
        <if test="repayDateStart != null and repayDateStart != ''">
            <![CDATA[   and  convert(datetime,repay_date, 20) >= convert(datetime,#{repayDateStart}, 20) ]]>
        </if>
        <if test="repayDateEnd != null and repayDateEnd != ''">
            <![CDATA[   and convert(datetime,repay_date, 20) <= convert(datetime,#{repayDateEnd}, 20) ]]>
        </if>
        and collect_user = #{odv}
        group by data_case
        ) r on t.id = r.data_case

    </select>

    <select id="findSameBatchCase1" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          select seq_no as seqNo,account,card_no as cardNo,money,currency_type as currencyType ,
          pro_repay_amt as proRepayAmt,bank_amt as bankAmt,en_repay_amt as enRepayAmt,account_age as accountAge,
          collect_date as collectDate
          from   data_case  where batch_no = #{batchNo} and ident_no = #{identNo} and status!=4 and  <![CDATA[ id <> #{id} ]]> and delete_flag=0

    </select>

    <select id="findSameBatchCase2" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select seq_no as seqNo,account,card_no as cardNo,money,currency_type as currencyType ,
        pro_repay_amt as proRepayAmt,bank_amt as bankAmt,en_repay_amt as enRepayAmt,account_age as accountAge,
        collect_date as collectDate
        from   data_case  where batch_no = #{batchNo} and ident_no = #{identNo} and status=4 and  <![CDATA[ id <> #{id} ]]> and delete_flag=0
        <if test="returnTime != null">
            <![CDATA[   and return_time >= #{returnTime} ]]>
        </if>
    </select>

    <select id="findBySeqNo" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select seq_no as seqNo
        from   data_case  where seq_no = #{seqNo} and delete_flag=0
    </select>

    <select id="findByCardNo" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select seq_no as seqNo
        from   data_case  where card_no = #{cardNo} and delete_flag=0
        <![CDATA[   and case_date >=convert(datetime,#{caseDateStart}, 20) and case_date <= convert(datetime,#{caseDateEnd}, 20)]]>
    </select>

    <select id="findSameCase" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          select t.id,t.batch_no as batchNo,t.seq_no as seqNo,dbo.fnFormatDate(t.case_date, 'yyyy-MM-dd') caseDate,t.card_no as cardNo,t.name,t.client,t.money,t.collect_status as collectStatus,
          t.odv,t.en_repay_amt as enRepayAmt
          from data_case t where t.delete_flag=0 and t.ident_no =
          (select ident_no from data_case where id = #{id}) and  <![CDATA[ t.id <> #{id} ]]>
    </select>

    <update id="addCollectTimes" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_times = collect_times+1  where id =#{id}
    </update>

    <update id="addBatchCollectTimes" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set collect_times = collect_times+#{collectTimes} where id =#{id}
    </update>

    <update id="updateDataCaseByCollect" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
          update data_case set new_case=#{newCase},collect_times=collect_times+1 where id=#{id}
    </update>

    <update id="updateDataCaseByCollect2" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set new_case=#{newCase} where id=#{id}
    </update>

    <update id="updateDataCaseByCollect3" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set new_case=#{newCase},collect_date = #{collectDate} where id=#{id}
    </update>

    <update id="updateDataCaseByCollectAdd" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set new_case=#{newCase},
        <if test="collectStatus != null and collectStatus != 0">
        collect_status=#{collectStatus},
        </if>
        summary=#{summary},
        collect_times=collect_times+1,collect_date=GETDATE(),pro_repay_amt = #{proRepayAmt},pro_repay_date = #{proRepayDate}
         where id=#{id}
    </update>

    <update id="updateDataCaseByCollectResult" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case set summary=#{summary} where id=#{id}
    </update>

    <select id="listByBatchNos" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select id from data_case where batch_no in
        <foreach item="item" index="index" collection="array" open="(" separator="," close=")">
            #{item}
        </foreach>
         and delete_flag=0
    </select>

    <select id="countUserCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" resultType="java.lang.Integer">
        select
        count(id) as num
        from data_case
        where delete_flag = 0 and odv = #{odv}
    </select>

    <update id="updateRepayMoney" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case
        set en_repay_amt = #{enRepayAmt},
            <if test="updateUser != null and updateUser.id != null">update_user = #{updateUser.id},</if>
            <if test="settleFlag != null and settleFlag == '已结清'.toString()">
                settle_flag = #{settleFlag},status = 3,
            </if>
            <if test="settleFlag != null and settleFlag != '已结清'">
                settle_flag = #{settleFlag},status = #{status},
            </if>
            <if test="repayDate != null and repayDate != ''">
                repay_date = #{repayDate},
            </if>
            balance = money - #{enRepayAmt},settle_date=GETDATE()
        where id = #{id}
    </update>

    <update id="updateCpMoney" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case
        set bank_amt = #{bankAmt},
        <if test="updateUser != null and updateUser.id != null">update_user = #{updateUser.id}</if>
        where id = #{id}
    </update>

    <update id="updateCollectInfo" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case
        set collect_result = #{collectInfo}
        where id = #{id}
    </update>

    <select id="selectCommonCase"  resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select sum(r.repayMoney) as enRepayAmt ,t.business_type as businessType
        from data_case t LEFT JOIN (
            select repay_money as repayMoney,data_case
            from data_case_repay_record
            where 1=1
            <![CDATA[   and  convert(datetime,repay_date, 20) >= convert(datetime,#{repayDateStart}, 20) ]]>
             <![CDATA[   and convert(datetime,repay_date, 20) <= convert(datetime,#{repayDateEnd}, 20) ]]>
            <if test="odv != null and odv != ''"> and collect_user = #{odv}</if>
         ) r on t.id = r.data_case
         where t.business_type not in ('上汽长账龄上汽拖车','上汽长账龄其他','上汽短期','安吉蓝海')
        and t.business_type is not null and t.business_type != '' and r.data_case is not null
        group by t.business_type
    </select>

    <select id="selectTsCase1"  resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select sum(r.repayMoney) as enRepayAmt,t.money,t.business_type as businessType,
        dbo.fnFormatDate(t.settle_date, 'yyyy-MM-dd') as settleDate,t.settle_flag as settleFlag
        from data_case t LEFT JOIN (
        select repay_money as repayMoney,data_case
        from data_case_repay_record
        where  1=1
        <![CDATA[   and convert(datetime,repay_date, 20) >= convert(datetime,#{repayDateStart}, 20)   ]]>
        <![CDATA[   and convert(datetime,repay_date, 20) <= convert(datetime,#{repayDateEnd}, 20)   ]]>
        <if test="odv != null and odv != ''"> and collect_user = #{odv}</if>
        ) r on t.id = r.data_case
        where t.business_type  in ('上汽长账龄上汽拖车','上汽长账龄其他') and r.data_case is not null
        group by t.money,t.business_type ,t.settle_date,t.settle_flag
    </select>

    <select id="selectTsCase2"  resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select sum(r.repayMoney) as enRepayAmt,t.money ,t.business_type as businessType
        from data_case t LEFT JOIN (
            select repay_money as repayMoney,data_case
            from data_case_repay_record
            where  1=1
            <![CDATA[   and convert(datetime,repay_date, 20) >= convert(datetime,#{repayDateStart}, 20)   ]]>
            <![CDATA[   and convert(datetime,repay_date, 20) <= convert(datetime,#{repayDateEnd}, 20)   ]]>
            <if test="odv != null and odv != ''"> and collect_user = #{odv}</if>
        ) r on t.id = r.data_case
        where t.business_type  in ('上汽短期','安吉蓝海') and r.data_case is not null
        group by t.business_type,t.money
    </select>

    <update id="updateCollectDate" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case
        set collect_date = #{collectDate}
        where id = #{id}  <![CDATA[   and (collect_date< convert(datetime,#{collectDate}, 20) or collect_date is null) ]]>
    </update>

    <select id="findSettleFlagBySeqNo" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select  seq_no as seqNo,settle_flag as settleFlag,status
        from   data_case  where seq_no = #{seqNo} and delete_flag=0
    </select>
    <select id="querySum" resultType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        select sum(da.money) as money,count(da.en_repay_amt) as repayNum,
                sum(da.en_repay_amt)as enRepayAmt, sum(da.bank_amt) as bankAmt,
                sum(da.pro_repay_amt)as proRepayAmt
        from data_case da
       /* left join data_case c2 on da.id=c2.id
        left join data_case c3 on da.id=c3.id
        left join data_case c4 on da.id=c4.id*/
        <where>
            da.delete_flag=0
            <trim suffixOverrides=",">
                <if test="idFlag != null and idFlag!=''">
                    and da.id in
                    <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="cardNoFlag != null and cardNoFlag!=''">
                    and da.card_no in
                    <foreach item="item" index="index" collection="cardNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="seqNoFlag != null and seqNoFlag!=''">
                    and da.seq_no in
                    <foreach item="item" index="index" collection="seqNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="identNoFlag != null and identNoFlag!=''">
                    and da.ident_no in
                    <foreach item="item" index="index" collection="identNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="nameFlag != null and identNoFlag!=''">
                    and da.name in
                    <foreach item="item" index="index" collection="names" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="accountFlag != null and accountFlag!=''">
                    and da.account in
                    <foreach item="item" index="index" collection="accounts" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="applyOrderNoFlag != null and applyOrderNoFlag != ''">
                    and da.apply_order_no in
                    <foreach item="item" index="index" collection="applyOrderNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="archiveNoFlag != null and archiveNoFlag!=''">
                    and da.archive_no in
                    <foreach item="item" index="index" collection="archiveNos" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="clientFlag != null and clientFlag!=''">
                    and da.client in
                    <foreach item="item" index="index" collection="clients" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="batchNoFlag != null and batchNoFlag!=''">
                    and da.batch_no in
                    <foreach item="item" index="index" collection="batchNos" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="odvFlag != null and odvFlag!=''">
                    and da.odv in
                    <foreach item="item" index="index" collection="odvs" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="vin != null and vin!=''">
                    and da.vin = #{vin}
                </if>
                <if test="license != null and license!=''">
                    and da.license = #{license}
                </if>
                <if test="collectHand != null and collectHand!=''">
                    and da.collect_hand = #{collectHand}
                </if>
                <if test="bank != null and bank!=''">
                    and da.bank = #{bank}
                </if>
                <if test="moneyStart != null and moneyStart!=''">
                    <![CDATA[   and da.money>=  #{moneyStart}  ]]>
                </if>
                <if test="moneyEnd != null and moneyEnd!=''" >
                    <![CDATA[   and da.money <=  #{moneyEnd}   ]]>
                </if>
                <if test="overdueDaysStart != null and overdueDaysStart!=''">
                    <![CDATA[   and da.overdue_days>=  #{overdueDaysStart}  ]]>
                </if>
                <if test="overdueDaysEnd != null and overdueDaysEnd!=''" >
                    <![CDATA[   and da.overdue_days <=  #{overdueDaysEnd}   ]]>
                </if>
                <!--<if test="overDays != null and overDays!=''">
                    and da.overdue_days = #{overDays}
                </if>-->
                <if test="collectInfo != null and collectInfo!=''">
                    and da.summary = #{collectInfo}
                </if>

                <if test="reduceStatus != null and reduceStatus!=''">
                    and da.reduce_status = #{reduceStatus}
                </if>
                <if test="accountAge != null and accountAge!=''">
                    and da.account_age = #{accountAge}
                </if>
                <if test="collectStatuss != null and collectStatuss.length > 0 ">
                    and da.collect_status in
                    <foreach item="item" index="index" collection="collectStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="color != null and color!=''">
                    and da.color = #{color}
                </if>
                <if test="area != null and area!=''">
                    and da.area = #{area}
                </if>
                <if test="province != null and province.name !=null and province.name !=''">
                    and da.province = #{province.name}
                </if>
                <if test="city != null and city.name !=null and city.name !=''">
                    and da.city = #{city.name}
                </if>
                <if test="county != null and county.name !=null and county.name !=''">
                    and da.county = #{county.name}
                </if>
                <if test="caseType != null and caseType!=''">
                    and da.case_type = #{caseType}
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='1'.toString()">
                    and da.odv is not null and da.distribute_status=1
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='2'.toString()">
                    and (da.odv is  null or da.odv='')
                </if>
                <if test="distributeStatusFlag != null and distributeStatusFlag=='3'.toString()">
                    and da.odv is not null
                </if>
                <if test="collectArea != null and collectArea!=''">
                    and da.collect_area = #{collectArea}
                </if>
                <if test="repayDateStart != null and repayDateStart!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')>=  #{repayDateStart}   ]]>
                </if>
                <if test="repayDateEnd != null and repayDateEnd!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.repay_date, 'yyyy-MM-dd')<=  #{repayDateEnd}   ]]>
                </if>
                <if test="caseDateStart != null and caseDateStart!=''">
                    <![CDATA[   and da.case_date>=  #{caseDateStart}  ]]>
                </if>
                <if test="caseDateEnd != null and caseDateEnd!=''" >
                    <![CDATA[   and da.case_date<=  #{caseDateEnd}   ]]>
                </if>
                <if test="expectStartTime != null and expectStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')>=  #{expectStartTime}   ]]>
                </if>
                <if test="expectEndTime != null and expectEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.expect_time, 'yyyy-MM-dd')<=  #{expectEndTime}   ]]>
                </if>
                <if test="realReturnStartTime != null and realReturnStartTime!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')>=  #{realReturnStartTime}  ]]>
                </if>
                <if test="realReturnEndTime != null and realReturnEndTime!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.real_return_time, 'yyyy-MM-dd')<=  #{realReturnEndTime}   ]]>
                </if>
                <if test="collectStartDate != null and collectStartDate!=''">
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectStartDate}   ]]>
                </if>
                <if test="collectEndDate != null and collectEndDate!=''" >
                    <![CDATA[   and dbo.fnFormatDate(da.collect_date, 'yyyy-MM-dd')>=  #{collectEndDate}   ]]>
                </if>

                <if test="collectAreas != null and collectAreas.length > 0 ">
                    and da.collect_area in
                    <foreach item="item" index="index" collection="collectAreas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="caseTypes != null and caseTypes.length > 0 ">
                    and da.case_type in
                    <foreach item="item" index="index" collection="caseTypes" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="depts != null and depts.length > 0 ">
                    and da.dept in
                    <foreach item="item" index="index" collection="depts" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reportStatuss != null and reportStatuss.length > 0 ">
                    and da.report_status in
                    <foreach item="item" index="index" collection="reportStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="reduceStatuss != null and reduceStatuss.length > 0 ">
                    and da.reduce_status in
                    <foreach item="item" index="index" collection="reduceStatuss" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="statuss != null and statuss.length > 0 ">
                    and da.status in
                    <foreach item="item" index="index" collection="statuss" open="(" separator="," close=")">
                        ${item}
                    </foreach>
                </if>

                <if test="accountAges != null and accountAges.length > 0 ">
                    and da.account_age in
                    <foreach item="item" index="index" collection="accountAges" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

                <if test="colors != null and colors.length > 0 and (colorFlag==null or colorFlag=='')">
                    and da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </if>
                <if test="colors != null and colors.length > 0 and colorFlag!=null and colorFlag!=''">
                    and (da.color is null or  da.color in
                    <foreach item="item" index="index" collection="colors" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                    )
                </if>

                <if test="areas != null and areas.length > 0 ">
                    and da.area in
                    <foreach item="item" index="index" collection="areas" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>

            </trim>
        </where>
    </select>

    <update id="updateDept" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseEntity">
        update data_case
        set dept = #{dept}
        where odv = #{odv}
    </update>

    <update id="updateDetailCase" parameterType="xyz.zaijushou.zhx.sys.entity.DataCaseDetail">
        update data_case set
        seq_no = #{seqNo},collect_hand=#{collectHand},name=#{name},collect_area=#{collectArea},gender=#{gender},client=#{client},
        ident_no=#{identNo},ident_type=#{identType},card_no=#{cardNo},case_date=#{caseDate},money=#{money},m_val=#{mVal},expect_time=#{expectTime},
        settle_flag=#{settleFlag},account_age=#{accountAge},overdue_days=#{overdueDays},province=#{provinceName},city=#{cityName},county=#{countyName},
        <if test="status != null">
            status = #{status},
        </if>
        commission_rate=#{commissionRate},commission_money=#{commissionMoney},entrust_periods=#{entrustPeriods},currency_type=#{currencyType},
        order_no=#{orderNo},goods=#{goods},rmb=#{rmb},hkd=#{hkd},foreign_currency=#{foreignCurrency},account=#{account},account_name=#{accountName},
        overdue_date=#{overdueDate},overdue_money=#{overdueMoney},overdue_principle=#{overduePrinciple},overdue_interest=#{overdueInterest},
        overdue_default_interest=#{overdueDefaultInterest},overdue_management_cost=#{overdueManagementCost},penalty=#{penalty},repay_deadline=#{repayDeadline},
        overdue_times=#{overdueTimes},repaid_periods=#{repaidPeriods},case_deadline=#{caseDeadline},archive_no=#{archiveNo},
        bank=#{bank},collection_type=#{collectionType},default_level=#{defaultLevel},card_type=#{cardType},credit_line=#{creditLine},fixed_quota=#{fixedQuota},
        minimum_payment=#{minimumPayment},late_fee=#{lateFee},overrun_fee=#{overrunFee},bill_cycle=#{billCycle},outstanding_amount=#{outstandingAmount},
        bill_date=#{billDate},active_card_date=#{activeCardDate},last_consume_date=#{lastConsumeDate},stop_card_date=#{stopCardDate},
        main_deputy_card=#{mainDeputyCard},deputy_card_user_name=#{deputyCardUserName},apply_order_no=#{applyOrderNo},last_withdraw_date=#{lastWithdrawDate},
        last_repay_money=#{lastRepayMoney},last_repay_date=#{lastRepayDate},bail=#{bail},principle=#{principle},loan_type=#{loanType},residual_principle=#{residualPrinciple},
        loan_date=#{loanDate},loan_deadline=#{loanDeadline}
        where id = #{id}
    </update>
</mapper>